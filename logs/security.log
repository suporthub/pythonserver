2025-06-29 21:41:10,791 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:41:10,792 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:41:10,796 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:41:10,796 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:41:46,972 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:46,972 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:46,983 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:46,989 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,035 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,038 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,091 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,094 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,127 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,127 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,131 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:51,250 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:41:51,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:41:51,250 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:41:51,250 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 5, 11, 51, 250235), 'iat': datetime.datetime(2025, 6, 30, 4, 41, 51, 250318)}
2025-06-29 21:41:51,251 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:41:51,251 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODYzMzExLCJpYXQiOjE3NTEyNTg1MTF9.txlYB-GgOelNHVtqQfIPVXb8d4MxNkXP7enR6SPHDO8, Expiry (seconds): 604800
2025-06-29 21:41:51,253 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 21:41:52,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,373 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,382 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,383 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,383 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,420 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,420 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:41:52,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,424 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,424 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,456 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,458 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,459 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,473 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,474 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,474 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,515 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,515 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,710 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,761 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,761 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:54,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:54,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:54,056 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:54,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:54,057 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:54,084 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:54,085 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:54,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:54,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:54,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,253 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:56,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:56,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,258 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:56,276 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:56,276 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:42:55,106 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:42:55,106 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:42:55,110 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:42:55,110 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:42:55,117 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:42:55,117 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 17, 55, 117158), 'iat': datetime.datetime(2025, 6, 30, 4, 42, 55, 117162)}
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:42:58,672 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:42:58,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:42:58,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:42:58,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:42:58,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:42:58,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:42:58,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:42:58,686 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:42:58,689 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:42:58,713 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:43:01,539 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:43:01,539 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:43:01,544 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:43:01,545 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:43:01,554 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:43:01,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:43:01,554 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:43:01,554 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 18, 1, 554568), 'iat': datetime.datetime(2025, 6, 30, 4, 43, 1, 554572)}
2025-06-29 21:43:01,555 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:43:03,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,263 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,263 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,263 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,269 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,269 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,270 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,497 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,497 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,498 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,506 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,507 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,527 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,527 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,528 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,528 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,535 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,535 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,535 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,609 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,609 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,617 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,617 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:04,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,143 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,143 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,143 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:04,152 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:04,153 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:04,478 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,479 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,696 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,696 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:04,702 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:04,702 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:17,077 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:43:17,080 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:50:42,682 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:50:42,682 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:50:42,688 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:50:42,688 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:50:42,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:50:42,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 25, 42, 695996), 'iat': datetime.datetime(2025, 6, 30, 4, 50, 42, 695998)}
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:50:43,705 - INFO - app.core.security - Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:50:44,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:50:44,442 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,442 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,442 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:50:44,572 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:50:44,572 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:51:03,436 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:51:03,436 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:52:01,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:52:01,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:52:01,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:52:01,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:52:01,796 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:52:01,798 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:52:01,798 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:52:40,338 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:52:40,339 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:58:45,854 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:58:45,854 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:58:45,858 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:58:45,858 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:58:45,867 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:58:45,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:58:45,867 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:58:45,867 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 33, 45, 867752), 'iat': datetime.datetime(2025, 6, 30, 4, 58, 45, 867756)}
2025-06-29 21:58:45,868 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:58:49,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:58:49,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:58:49,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:58:50,821 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:58:50,823 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:59:14,618 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:59:14,619 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:59:31,031 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:59:31,031 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:59:31,036 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:59:31,036 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:59:31,047 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:59:31,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:59:31,048 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:59:31,048 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 34, 31, 47709), 'iat': datetime.datetime(2025, 6, 30, 4, 59, 31, 47714)}
2025-06-29 21:59:31,049 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:59:34,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:34,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:34,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:42,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:42,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,568 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:59:42,578 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:59:42,579 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:59:56,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:56,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:56,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:56,373 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:59:56,377 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:00:43,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:00:43,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:00:43,399 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:00:43,400 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:00:43,400 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:00:43,407 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:00:43,408 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:01:18,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:01:18,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:01:18,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:01:18,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:01:18,493 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:01:18,500 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:01:18,500 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:02:02,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:02:02,372 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:02:02,376 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:02:02,376 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:02:10,525 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:02:10,526 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:04:18,643 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:04:18,643 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:04:18,648 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:04:18,648 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:04:18,659 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:04:18,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:04:18,660 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:04:18,660 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 39, 18, 659907), 'iat': datetime.datetime(2025, 6, 30, 5, 4, 18, 659912)}
2025-06-29 22:04:18,661 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:04:23,383 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:23,383 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:23,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:25,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:25,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:25,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:25,782 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:04:25,792 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:04:35,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:35,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:35,113 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:35,113 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:35,113 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:04:35,155 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:04:35,156 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:08,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:08,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:08,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:08,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:08,648 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:08,652 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:08,652 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:22,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:22,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:22,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:22,231 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:05:22,232 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:31,649 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:31,649 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:31,657 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:31,658 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:44,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:44,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:44,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:44,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:44,437 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:44,477 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:44,478 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:50,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:50,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:50,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:50,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:50,497 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:50,653 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:50,654 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:26,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:26,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:26,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:26,871 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:26,872 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:26,889 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:26,890 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:41,457 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:41,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:41,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:41,464 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:06:41,478 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:06:49,570 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:49,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:49,571 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:49,571 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:49,571 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:49,610 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:49,611 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:54,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:54,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:54,510 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:54,511 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:54,511 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:54,581 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:54,583 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:09,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:09,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:09,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:09,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:09,522 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:07:09,542 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:07:09,543 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:24,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:24,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:24,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:24,701 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:24,723 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:26,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:26,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:26,646 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:26,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:26,648 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:07:26,721 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:07:26,721 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:26,722 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:26,745 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:29,452 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:07:29,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:07:29,453 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:07:29,454 - DEBUG - app.core.security - Payload to encode: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': datetime.datetime(2025, 6, 30, 5, 37, 29, 452744), 'iat': datetime.datetime(2025, 6, 30, 5, 7, 29, 452770)}
2025-06-29 22:07:29,455 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:07:29,456 - INFO - app.core.security - Storing refresh token for user ID 9 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTE4NjQ4NDksImlhdCI6MTc1MTI2MDA0OX0.BJWdBaaEjNDcqGX3XKkcKerLslg6xu14nQIYbpXugO0, Expiry (seconds): 604800
2025-06-29 22:07:29,466 - INFO - app.core.security - Refresh token stored successfully for user ID: 9
2025-06-29 22:07:30,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,684 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,684 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,684 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:30,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,697 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,701 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,741 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,742 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,742 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,828 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,828 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:30,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,840 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,841 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,867 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,867 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,868 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,908 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,913 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,965 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,967 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:32,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:32,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:32,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:32,986 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:32,991 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:33,062 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:33,062 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:33,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:33,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:33,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:33,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:33,303 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:33,352 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:33,353 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:33,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:33,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:33,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:37,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:37,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,341 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,341 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:37,397 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:37,398 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:37,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:37,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:37,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,937 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:38,055 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:38,055 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:47,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:47,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:47,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,817 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,818 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:47,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:47,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:47,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,820 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:47,869 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:47,869 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:47,870 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:08:00,951 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:08:00,959 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:14:04,296 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:14:04,297 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:14:04,300 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:14:04,300 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:14:04,307 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:14:04,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:14:04,307 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:14:04,307 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 49, 4, 307545), 'iat': datetime.datetime(2025, 6, 30, 5, 14, 4, 307548)}
2025-06-29 22:14:04,308 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:14:06,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:06,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:06,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:06,618 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEyNjE4NDksImlhdCI6MTc1MTI2MDA0OX0.GN6kWyARMD62hEDHBYRNohemfXUUKWThaYD1Qt5XbdQ
2025-06-29 22:14:06,619 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEyNjE4NDksImlhdCI6MTc1MTI2MDA0OX0.GN6kWyARMD62hEDHBYRNohemfXUUKWThaYD1Qt5XbdQ
2025-06-29 22:14:10,787 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:10,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:10,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:10,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:10,789 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:14:11,134 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:14:11,134 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:11,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:11,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:11,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:12,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:12,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,625 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,625 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:12,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:12,626 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:12,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,629 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:14:12,737 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:14:12,739 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:12,740 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:27,833 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:14:27,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:14:27,834 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:14:27,834 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 5, 44, 27, 833747), 'iat': datetime.datetime(2025, 6, 30, 5, 14, 27, 833765)}
2025-06-29 22:14:27,835 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:14:27,836 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY1MjY3LCJpYXQiOjE3NTEyNjA0Njd9.AmWi-IiaMfpzb7qlzBNIsNlURySrS4MSAm4Hg0JNqBU, Expiry (seconds): 604800
2025-06-29 22:14:27,839 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 22:14:29,518 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,519 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,519 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,520 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,529 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,529 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,529 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,554 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,554 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:29,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,556 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,724 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,724 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,725 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,854 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,855 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,855 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,966 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,966 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:30,931 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:30,932 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:30,933 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:30,933 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:30,934 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:30,964 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:30,965 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:32,001 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:32,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:32,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:32,003 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:32,003 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:32,015 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:32,015 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:34,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:34,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:34,894 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:34,894 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:34,894 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:34,897 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:34,897 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:35,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:35,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:35,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:42,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:42,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,361 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,361 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,363 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,364 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:42,411 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:42,411 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:42,412 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:43,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:43,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:43,898 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,898 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,899 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:43,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:43,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:43,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,900 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:43,930 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:43,931 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:43,931 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:45,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:45,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:45,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,912 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,913 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:45,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:45,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:45,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,921 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:46,044 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:46,044 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:46,045 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:47,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:47,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:47,902 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,902 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,903 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:47,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:47,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:47,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,906 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,907 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:47,945 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:47,945 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:47,946 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:09,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:09,081 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:09,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:09,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:09,083 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:09,114 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:09,114 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,211 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,213 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,213 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,214 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,225 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,226 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,226 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,274 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,274 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,275 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:15:22,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,276 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,276 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,279 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,305 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,306 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,307 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,337 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,338 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,338 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,374 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,375 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,419 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,419 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,459 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,467 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:25,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:25,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:25,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:25,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:25,373 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:25,408 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:25,409 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:25,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:25,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:25,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,930 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:28,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:28,932 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,932 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,932 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:28,958 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:28,959 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:16:22,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:16:22,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:16:22,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:22,535 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYyMjY3LCJpYXQiOjE3NTEyNjA0Njd9.pwt4w70KkizEICpI1vT4h-hVphMbDiPvl7OZa6gCS68
2025-06-29 22:16:22,537 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYyMjY3LCJpYXQiOjE3NTEyNjA0Njd9.pwt4w70KkizEICpI1vT4h-hVphMbDiPvl7OZa6gCS68
2025-06-29 22:16:36,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:16:36,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:16:36,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:36,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:36,754 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:16:36,778 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:16:36,778 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:17:09,462 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:17:09,463 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:53:36,498 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:53:36,498 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:53:36,501 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:53:36,502 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:53:36,511 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:53:36,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:53:36,511 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:53:36,511 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 28, 36, 511227), 'iat': datetime.datetime(2025, 6, 30, 5, 53, 36, 511236)}
2025-06-29 22:53:36,512 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:54:24,746 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:54:24,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:54:24,746 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:54:24,746 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 6, 24, 24, 745972), 'iat': datetime.datetime(2025, 6, 30, 5, 54, 24, 745984)}
2025-06-29 22:54:24,748 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:54:24,749 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY3NjY0LCJpYXQiOjE3NTEyNjI4NjR9.XKgibxFBwq4I4Px6SWgDIkMwDh6E0ST4I02CAx2nJzo, Expiry (seconds): 604800
2025-06-29 22:54:24,763 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 22:54:25,909 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,910 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,910 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,911 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:25,925 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:25,926 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:25,931 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:25,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,968 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,968 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:54:25,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,979 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,980 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,014 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,014 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,014 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,033 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,045 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,046 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,349 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:26,349 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:26,352 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,353 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,353 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,372 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,372 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:27,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:27,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:27,259 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:27,259 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:27,259 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:27,267 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:27,267 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:28,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:28,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,179 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:28,195 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:28,195 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:58,918 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:54:58,919 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:19:13,212 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:19:13,212 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:19:13,215 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:19:13,215 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:19:13,221 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:19:13,221 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 54, 13, 221092), 'iat': datetime.datetime(2025, 6, 30, 6, 19, 13, 221094)}
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:19:16,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:16,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:16,397 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:20,547 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:19:20,549 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:19:27,908 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:27,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:27,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,909 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,910 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,911 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:27,923 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:27,924 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:27,924 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:28,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:28,742 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:28,742 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,742 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,743 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,744 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,744 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:28,773 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:28,774 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:28,775 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:29,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:29,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,557 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,557 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,558 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,558 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:29,571 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:29,572 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:29,572 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:30,382 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:30,382 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:30,383 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,383 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,384 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,385 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,385 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:30,406 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:30,407 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:30,407 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:31,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:31,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:31,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:31,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:31,687 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:31,706 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:31,707 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:33,246 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:33,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:33,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:33,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:33,247 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:33,261 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:33,261 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:38,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:38,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:38,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:38,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:38,865 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:38,872 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:38,872 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:48,343 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:48,343 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:48,350 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:48,350 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:05,948 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:05,949 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:05,959 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:05,959 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:20,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:20,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:20,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:20,361 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:20:20,364 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:20:47,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:47,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:47,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:47,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:47,067 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:47,069 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:47,070 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:51,060 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:51,060 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:51,063 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:51,063 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:53,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:53,330 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:53,332 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:53,332 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:56,367 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:20:56,369 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:21:20,419 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:21:20,419 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:21:20,423 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:21:20,424 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:21:20,433 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:21:20,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:21:20,433 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:21:20,433 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 56, 20, 433664), 'iat': datetime.datetime(2025, 6, 30, 6, 21, 20, 433667)}
2025-06-29 23:21:20,434 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:21:25,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:21:25,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:21:25,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:06,384 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:06,384 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:08,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:08,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:08,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:08,165 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:08,165 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:08,169 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:08,169 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:09,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:09,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:09,262 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:09,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:09,263 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:09,269 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:09,269 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:58,069 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:22:58,070 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:23:00,251 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:23:00,252 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:23:00,255 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:23:00,255 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:23:00,263 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:23:00,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:23:00,263 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:23:00,263 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 58, 0, 263413), 'iat': datetime.datetime(2025, 6, 30, 6, 23, 0, 263416)}
2025-06-29 23:23:00,264 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:23:02,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:02,392 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:02,392 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:23,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:23,441 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,441 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,441 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:23:23,449 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:23:23,449 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:23:23,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:23,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:23,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,471 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:23:23,476 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:23:23,476 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:23:25,304 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:23:25,304 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:26:26,218 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:26:26,219 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:26:26,228 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:26:26,228 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:26:26,234 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:26:26,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:26:26,234 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:26:26,234 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 1, 26, 234581), 'iat': datetime.datetime(2025, 6, 30, 6, 26, 26, 234588)}
2025-06-29 23:26:26,235 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:26:27,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:27,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:27,934 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 23:26:30,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:30,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:30,735 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 23:26:34,241 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:26:34,241 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 6, 56, 34, 241070), 'iat': datetime.datetime(2025, 6, 30, 6, 26, 34, 241075)}
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:26:34,241 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY5NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.1CI2M3SnTBh7ncTGY0-jr7cE89v3CV49yWPVTL2PHHE, Expiry (seconds): 604800
2025-06-29 23:26:34,242 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 23:26:35,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,352 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,353 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,353 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:26:35,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,354 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,354 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,355 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,390 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,390 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,390 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,465 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,465 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,512 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,519 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,519 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:26:35,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,524 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,524 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,524 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,536 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,537 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,727 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,727 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,727 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,804 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,809 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,809 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,826 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,827 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:38,276 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:38,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:38,280 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:38,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:38,280 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:38,301 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:38,306 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:38,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:38,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:38,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:44,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:44,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,064 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:44,119 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:44,120 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:27:50,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:27:50,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:27:50,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:27:50,481 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:27:50,481 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:27:50,483 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:27:50,483 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:28:25,509 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:28:25,509 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:28:27,793 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:28:27,794 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:28:27,797 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:28:27,797 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:28:27,802 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:28:27,802 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 3, 27, 802230), 'iat': datetime.datetime(2025, 6, 30, 6, 28, 27, 802233)}
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:28:29,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:28:29,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:28:29,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:28:39,238 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:28:39,238 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:29:52,727 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:29:52,727 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:29:52,730 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:29:52,730 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:29:52,738 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:29:52,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:29:52,738 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:29:52,738 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 4, 52, 738636), 'iat': datetime.datetime(2025, 6, 30, 6, 29, 52, 738642)}
2025-06-29 23:29:52,739 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:29:55,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:29:55,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:29:55,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:07,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:07,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:07,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:07,850 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:30:07,851 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:30:13,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:13,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:13,861 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,862 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,862 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:30:13,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:13,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:13,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,863 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:13,880 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:13,880 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:13,880 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:17,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:17,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:17,096 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,096 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,096 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:30:17,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:17,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:17,097 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,097 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,097 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:17,130 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:17,131 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:17,131 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:20,494 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:20,494 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:20,572 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:20,573 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:31:13,398 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:31:13,399 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:32:36,293 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:32:36,294 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:32:36,296 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:32:36,296 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:32:36,303 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:32:36,303 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 7, 36, 303491), 'iat': datetime.datetime(2025, 6, 30, 6, 32, 36, 303494)}
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:32:38,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:38,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:38,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:45,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:45,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:45,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:45,601 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:32:45,602 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:32:48,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:48,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:48,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:48,241 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:48,241 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:32:48,246 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:32:48,247 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:33:03,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:33:03,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:33:03,183 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:33:03,183 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:33:03,183 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:33:03,197 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:33:03,197 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:33:42,283 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:33:42,283 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:34:20,907 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:34:20,907 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:34:20,911 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:34:20,911 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:34:20,917 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:34:20,917 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:34:20,917 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:34:20,917 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 9, 20, 917420), 'iat': datetime.datetime(2025, 6, 30, 6, 34, 20, 917425)}
2025-06-29 23:34:20,918 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:34:49,111 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:34:49,111 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:34:49,115 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:34:49,116 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:34:49,124 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:34:49,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:34:49,124 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:34:49,124 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 9, 49, 124562), 'iat': datetime.datetime(2025, 6, 30, 6, 34, 49, 124566)}
2025-06-29 23:34:49,125 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:34:50,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:34:50,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:34:50,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:35:06,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:35:06,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,713 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:35:06,715 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:35:06,716 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:22,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:22,694 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:36:22,697 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:36:22,697 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:32,940 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:36:32,941 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:36:35,803 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:36:35,803 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:36:35,806 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:36:35,806 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:36:35,810 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:36:35,811 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 11, 35, 810972), 'iat': datetime.datetime(2025, 6, 30, 6, 36, 35, 810974)}
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:36:37,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:37,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:37,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:37,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:37,258 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:36:37,403 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:36:37,403 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:11,923 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:37:11,923 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:37:13,946 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:37:13,946 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:37:13,950 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:37:13,950 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:37:13,955 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:37:13,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:37:13,955 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:37:13,955 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 12, 13, 955721), 'iat': datetime.datetime(2025, 6, 30, 6, 37, 13, 955723)}
2025-06-29 23:37:13,956 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:37:15,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:15,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:15,385 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:17,724 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:17,724 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:17,725 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:17,725 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:37:17,726 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:37:38,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:38,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:38,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:38,255 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:38,255 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:37:38,264 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:37:38,264 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:40,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:40,120 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:37:40,127 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:37:40,128 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:37:50,881 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:37:50,882 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:09:17,034 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:09:17,035 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:09:17,044 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:09:17,044 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:09:17,053 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:09:17,053 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 44, 17, 53285), 'iat': datetime.datetime(2025, 6, 30, 10, 9, 17, 53289)}
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:09:21,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:09:21,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:09:21,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:09:24,421 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:09:24,422 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:12:07,652 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:12:07,652 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:12:07,657 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:12:07,657 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:12:07,663 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:12:07,664 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 47, 7, 663952), 'iat': datetime.datetime(2025, 6, 30, 10, 12, 7, 663957)}
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:12:09,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:12:09,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:12:09,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:12:13,358 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:12:13,358 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:15:03,223 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:15:03,223 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:15:03,226 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:15:03,226 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:15:03,230 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:15:03,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:15:03,231 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:15:03,231 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 50, 3, 230913), 'iat': datetime.datetime(2025, 6, 30, 10, 15, 3, 230917)}
2025-06-30 03:15:03,231 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:15:05,129 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:15:05,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:15:05,130 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,827 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:15:06,841 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:15:06,842 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:15:18,495 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:15:18,497 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:16:56,590 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:16:56,590 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:16:56,593 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:16:56,593 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:16:56,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:16:56,600 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 51, 56, 599923), 'iat': datetime.datetime(2025, 6, 30, 10, 16, 56, 599928)}
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:18:08,451 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:18:08,452 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:18:12,334 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:18:12,334 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:18:12,338 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:18:12,339 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:18:12,344 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:18:12,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:18:12,344 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:18:12,344 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 53, 12, 344260), 'iat': datetime.datetime(2025, 6, 30, 10, 18, 12, 344266)}
2025-06-30 03:18:12,345 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:18:49,639 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:18:49,641 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:18:55,731 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:18:55,731 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:18:55,735 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:18:55,736 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:18:55,740 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:18:55,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:18:55,740 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:18:55,741 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 53, 55, 740872), 'iat': datetime.datetime(2025, 6, 30, 10, 18, 55, 740875)}
2025-06-30 03:18:55,741 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:19:33,375 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:19:33,377 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:20:51,140 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:20:51,140 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:20:51,144 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:20:51,144 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:20:51,148 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:20:51,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:20:51,149 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:20:51,149 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 55, 51, 148915), 'iat': datetime.datetime(2025, 6, 30, 10, 20, 51, 148919)}
2025-06-30 03:20:51,149 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:21:33,717 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,719 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,719 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,722 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,722 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,744 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,744 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyNzg5MDMsImlhdCI6MTc1MTI3NzEwM30.7N8ihtaJZm5ZqIZBpgn5J56mNN36n3A_uJhAX_45Txw
2025-06-30 03:21:33,745 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyNzg5MDMsImlhdCI6MTc1MTI3NzEwM30.7N8ihtaJZm5ZqIZBpgn5J56mNN36n3A_uJhAX_45Txw
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,761 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,765 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,766 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,823 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,825 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,838 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,888 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,889 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,914 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,914 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,918 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,918 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,947 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,947 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,953 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,953 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,993 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,993 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,993 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:34,001 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:34,002 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:34,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:34,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:34,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:34,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:34,033 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:34,039 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:34,039 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:36,853 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:36,853 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:36,854 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:36,854 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:36,854 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:36,858 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:36,858 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:18,307 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:18,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:18,308 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 03:22:18,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:18,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:18,493 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 03:22:18,497 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 03:22:31,196 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:22:31,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:22:31,197 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:22:31,197 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 10, 52, 31, 196175), 'iat': datetime.datetime(2025, 6, 30, 10, 22, 31, 196259)}
2025-06-30 03:22:31,199 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:22:31,200 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODM3NTEsImlhdCI6MTc1MTI3ODk1MX0.pacNe5osQIpSmhN_r7qeka1nsmPKH3_FCUK62R1-h0Q, Expiry (seconds): 604800
2025-06-30 03:22:31,204 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:22:32,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,435 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,435 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:22:32,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,436 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,436 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,443 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,443 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,443 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,466 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,467 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:22:32,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,468 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,468 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,475 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,476 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,476 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,487 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,487 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,495 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,496 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,668 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,668 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,684 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,684 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,087 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,087 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,088 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:33,100 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:33,101 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,762 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:33,770 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:33,770 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:23:48,868 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:23:48,868 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:07,003 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:07,003 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:25:07,005 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:25:07,006 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:25:13,342 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:25:13,344 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:25:17,822 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:25:17,823 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:25:17,829 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:25:17,830 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:25:17,836 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:25:17,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:25:17,836 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:25:17,836 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 0, 17, 836691), 'iat': datetime.datetime(2025, 6, 30, 10, 25, 17, 836696)}
2025-06-30 03:25:17,837 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:25:19,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:19,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:19,799 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:24,689 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:25:24,690 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:25:28,941 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:25:28,942 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:25:28,947 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:25:28,947 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:25:28,955 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:25:28,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:25:28,955 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:25:28,955 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 0, 28, 955146), 'iat': datetime.datetime(2025, 6, 30, 10, 25, 28, 955150)}
2025-06-30 03:25:28,956 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:25:30,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:30,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:30,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:48,674 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:27:48,675 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:27:48,679 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:27:48,679 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:27:48,689 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:27:48,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:27:48,689 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:27:48,689 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 2, 48, 689090), 'iat': datetime.datetime(2025, 6, 30, 10, 27, 48, 689097)}
2025-06-30 03:27:48,690 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:27:53,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:27:53,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:27:53,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:55,834 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:27:55,835 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:05,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:28:05,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:28:05,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:28:05,330 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:05,332 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:32,283 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:28:32,284 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:41:34,224 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:41:34,225 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:41:34,229 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:41:34,229 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:41:34,236 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:41:34,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:41:34,236 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:41:34,236 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 16, 34, 236308), 'iat': datetime.datetime(2025, 6, 30, 10, 41, 34, 236312)}
2025-06-30 03:41:34,237 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:41:39,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:39,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:39,647 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:41:52,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:52,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:52,518 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:41:52,518 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:41:52,518 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:41:56,537 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:41:56,537 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 11, 56, 537116), 'iat': datetime.datetime(2025, 6, 30, 10, 41, 56, 537123)}
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:41:56,538 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODQ5MTYsImlhdCI6MTc1MTI4MDExNn0.eDmFMTxpQhAQCZmjlcF9Yucbaee8maMn9kT-tPQVT_I, Expiry (seconds): 604800
2025-06-30 03:41:56,538 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:41:57,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,606 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,613 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,613 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,613 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,626 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,630 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,632 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,633 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,633 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,636 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,636 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,813 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,813 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,817 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,817 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,949 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,949 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,951 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,951 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:00,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:00,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,064 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:00,073 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:00,073 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:03,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:03,581 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:03,585 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:03,585 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:09,994 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:09,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:09,999 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:09,999 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:09,999 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:10,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,599 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,599 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:10,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:10,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,600 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,600 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:10,605 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:10,606 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:10,606 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:20,582 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:42:20,583 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:43:17,179 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:43:17,180 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:43:17,184 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:43:17,184 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:43:17,188 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:43:17,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:43:17,188 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:43:17,188 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 18, 17, 188723), 'iat': datetime.datetime(2025, 6, 30, 10, 43, 17, 188731)}
2025-06-30 03:43:17,189 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:43:20,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:20,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:20,606 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:23,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:23,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:23,758 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:23,758 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:23,759 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:27,579 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:27,580 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:31,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:31,071 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:31,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:31,072 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:31,072 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:40,759 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:43:40,760 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:44:21,112 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:44:21,113 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:44:21,117 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:44:21,117 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:44:21,120 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:44:21,120 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 19, 21, 120122), 'iat': datetime.datetime(2025, 6, 30, 10, 44, 21, 120123)}
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:44:24,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:24,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:24,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:25,858 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:44:25,859 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:29,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:29,299 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:44:29,302 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:44:29,302 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:44:38,131 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:44:38,132 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:58:04,860 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:58:04,860 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:58:04,864 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:58:04,864 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:58:04,871 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:58:04,871 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 33, 4, 871496), 'iat': datetime.datetime(2025, 6, 30, 10, 58, 4, 871499)}
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:58:07,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:07,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:07,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:58:09,544 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:58:09,544 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:58:13,829 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:58:13,829 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:58:13,829 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:58:13,829 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 28, 13, 829516), 'iat': datetime.datetime(2025, 6, 30, 10, 58, 13, 829523)}
2025-06-30 03:58:13,830 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:58:13,830 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODU4OTMsImlhdCI6MTc1MTI4MTA5M30.tC1mQFEFGzlRyCKqAdjjyw30RLGuU8z2moF3iu5pzv4, Expiry (seconds): 604800
2025-06-30 03:58:13,832 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:58:14,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,934 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,934 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,935 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,935 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,939 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,939 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,939 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,945 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,945 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,946 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,951 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,951 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,952 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,956 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,956 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,956 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,961 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,961 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,207 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,207 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,211 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,211 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,245 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,245 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,245 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,262 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,262 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,466 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,466 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,471 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,471 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,518 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:26,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:26,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,967 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,967 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:26,970 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:26,971 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:45,556 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:58:45,558 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:59:45,600 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:59:45,600 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:59:45,605 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:59:45,605 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:59:45,612 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:59:45,612 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 34, 45, 612486), 'iat': datetime.datetime(2025, 6, 30, 10, 59, 45, 612489)}
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:59:47,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:47,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:47,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:47,201 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:47,204 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 03:59:53,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:53,473 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:53,473 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:53,473 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:53,474 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:53,480 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:53,480 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:59:57,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:57,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:57,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:57,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:57,033 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:57,037 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:57,037 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:59:59,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:59,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:59,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:59,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:59,379 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:59,383 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:59,383 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:00:33,343 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:00:33,343 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:02:15,690 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:02:15,690 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:02:15,693 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:02:15,693 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:02:15,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:02:15,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 37, 15, 696499), 'iat': datetime.datetime(2025, 6, 30, 11, 2, 15, 696501)}
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:02:20,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,916 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,916 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:20,917 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,917 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,917 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:20,930 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:20,930 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:20,930 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,601 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,601 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,602 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,602 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:21,608 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:21,608 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,608 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,208 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,208 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,209 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,209 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:22,227 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:22,227 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,227 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,861 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,861 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,862 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,862 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:22,875 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:22,876 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,876 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:59,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:59,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:59,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:59,696 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:02:59,698 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,017 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,017 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,018 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,018 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:04,021 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:04,021 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,021 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,040 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,040 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,041 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,041 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,041 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:04,046 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:04,046 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,046 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:12,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:12,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:12,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:12,842 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:12,846 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:22,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:22,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:22,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:22,388 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:22,388 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:22,396 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:22,397 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:26,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:26,404 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:26,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:26,405 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:26,405 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:26,411 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:26,411 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:29,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:29,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:29,316 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:29,316 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:29,316 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:29,322 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:29,322 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:35,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:35,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:35,391 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:35,392 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:35,392 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:40,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:40,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:40,376 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,376 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:40,382 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:40,382 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:40,382 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:42,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:42,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,888 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,888 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,889 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,889 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:42,892 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:42,892 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:42,892 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:53,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:53,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:53,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:53,883 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:53,883 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:53,888 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:53,889 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:56,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:56,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:56,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:56,774 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:56,774 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:56,779 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:56,779 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:59,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:59,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:59,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:59,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:59,694 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:59,701 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:59,701 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:04:13,948 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:04:13,948 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:04:15,942 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:04:15,942 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:04:15,945 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:04:15,945 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:04:15,948 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:04:15,948 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 39, 15, 948296), 'iat': datetime.datetime(2025, 6, 30, 11, 4, 15, 948298)}
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:04:19,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:04:19,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:04:19,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:04:27,674 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:04:27,675 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:17:30,358 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:17:30,358 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:17:30,361 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:17:30,361 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:17:30,368 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:17:30,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:17:30,368 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:17:30,368 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 52, 30, 368877), 'iat': datetime.datetime(2025, 6, 30, 11, 17, 30, 368879)}
2025-06-30 04:17:30,369 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:17:32,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:32,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:32,297 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:17:32,297 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:17:32,298 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:17:33,969 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:33,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:33,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:17:37,492 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:17:37,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:17:37,492 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:17:37,492 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 47, 37, 492308), 'iat': datetime.datetime(2025, 6, 30, 11, 17, 37, 492318)}
2025-06-30 04:17:37,493 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:17:37,493 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODcwNTcsImlhdCI6MTc1MTI4MjI1N30.n3Lsq3ifbl0jCqu10AB1rPD0ouNXeX--HIIDRXrjvEo, Expiry (seconds): 604800
2025-06-30 04:17:37,503 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,767 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,767 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,768 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,768 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,772 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,772 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,772 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,784 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,784 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,785 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,785 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,791 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,791 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,791 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,796 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,796 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,814 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,814 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,071 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,072 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,072 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:39,075 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:39,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,300 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,300 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:39,304 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:39,304 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:41,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:41,047 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,047 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,047 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:41,057 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:41,057 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:46,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:46,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:46,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:46,666 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:46,667 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:46,676 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:46,676 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:53,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:53,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:53,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:53,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:53,471 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:53,476 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:53,476 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:18:15,659 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:18:15,660 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:18:15,662 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:18:15,663 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:18:39,306 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:18:39,307 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:20:57,896 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:20:57,897 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:20:57,900 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:20:57,900 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:20:57,903 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:20:57,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:20:57,903 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:20:57,903 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 55, 57, 903693), 'iat': datetime.datetime(2025, 6, 30, 11, 20, 57, 903695)}
2025-06-30 04:20:57,904 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:20:59,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:20:59,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:20:59,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:20:59,791 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:20:59,792 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:20:59,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:20:59,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:20:59,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:06,243 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:06,243 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:11,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,006 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,006 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:11,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:11,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,007 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:11,020 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:11,021 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:11,021 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:13,642 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:13,643 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:13,643 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:19,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:19,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:19,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:19,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:19,919 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:19,926 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:19,926 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:24,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:24,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:24,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:24,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:24,453 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:24,461 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:24,461 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:34,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:34,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:34,317 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:34,317 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:34,317 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:34,324 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:34,325 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:46,993 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:46,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:46,994 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:46,994 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:21:46,996 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:22:22,123 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:22:22,123 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:26:11,842 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:26:11,842 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:26:11,846 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:26:11,846 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:26:11,852 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:26:11,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:26:11,852 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:26:11,852 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 1, 11, 852541), 'iat': datetime.datetime(2025, 6, 30, 12, 26, 11, 852543)}
2025-06-30 05:26:11,857 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:26:14,075 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:26:14,075 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:26:23,129 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:26:23,129 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:26:23,135 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:26:23,135 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:26:23,140 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:26:23,140 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 1, 23, 140353), 'iat': datetime.datetime(2025, 6, 30, 12, 26, 23, 140355)}
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:26:29,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:29,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:29,632 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:30,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:30,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:30,599 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:30,600 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:31,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:31,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:31,687 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:31,688 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:35,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:35,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:35,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:38,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:38,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:38,301 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:38,301 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:41,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:41,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:41,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:47,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:47,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:47,615 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:52,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:52,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:52,598 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:52,599 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:53,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:53,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:53,605 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:59,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:59,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:59,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:03,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:03,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:03,291 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:03,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:05,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:05,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:05,619 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:11,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:11,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:11,613 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:11,613 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:11,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:11,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:11,616 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:17,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:17,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:17,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:23,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:23,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:23,816 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:29,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:29,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:29,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:35,651 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:35,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:35,651 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:41,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:41,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:41,654 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:44,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:44,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:44,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:44,297 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:47,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:47,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:47,746 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:48,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:48,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,297 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:48,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:48,688 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:48,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,689 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:49,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:49,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:49,284 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:49,285 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:53,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:53,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:53,290 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:53,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:53,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:53,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:53,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:59,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:59,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:59,608 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:05,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:05,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:05,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:10,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:10,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:10,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:10,614 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:11,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:11,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:11,615 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:17,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:17,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:17,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:18,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:18,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:18,288 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:18,290 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:23,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:23,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:23,784 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:29,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:29,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:29,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:29,606 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:29,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:29,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:29,654 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:35,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:35,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:35,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:41,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:41,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:41,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:47,683 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:47,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:47,683 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:53,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:53,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:53,635 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:59,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:59,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:59,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:59,294 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:59,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:59,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:59,658 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:04,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:04,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:04,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:04,293 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:05,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:05,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:05,675 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:05,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:05,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:05,692 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:05,694 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:10,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:10,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:10,287 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:10,289 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:11,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:11,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:11,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,773 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,774 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:16,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,782 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,955 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:22,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:22,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:22,656 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:26,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:26,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:26,298 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:26,300 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:28,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:28,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:28,620 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:34,620 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:34,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:34,621 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:36,626 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:36,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:36,627 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:36,635 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:40,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:40,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:40,622 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:44,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:44,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:44,618 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:44,620 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:46,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:46,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:46,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:52,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:52,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:52,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:58,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:58,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:58,626 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:04,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:04,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:04,612 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:10,643 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:10,643 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:10,644 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:16,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:16,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:16,599 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:16,601 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:16,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:16,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:16,619 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:19,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:19,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:19,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:19,295 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:21,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:21,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:21,708 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:21,711 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:22,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:22,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:22,633 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:28,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:28,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:28,298 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:28,300 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:28,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:28,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:28,628 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:34,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:34,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:34,649 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:40,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:40,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:40,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:42,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:42,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:42,601 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:42,603 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:46,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:46,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:46,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:51,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:51,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:51,588 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:51,590 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:52,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:52,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:52,639 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:58,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:58,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:58,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:59,603 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:59,603 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:59,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:59,605 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:04,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:04,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:04,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:10,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:10,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:10,661 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:16,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:16,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:16,685 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:21,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:21,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:21,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:21,611 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:22,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:22,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:22,629 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:28,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:28,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:28,629 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:30,637 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:30,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:30,637 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:30,639 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:34,770 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:34,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:34,771 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:35,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:35,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:35,291 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:35,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:39,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:39,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:39,462 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:39,463 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:40,828 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:40,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:40,829 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:44,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:44,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:44,286 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:44,286 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:46,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:46,610 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:46,610 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:52,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:52,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:52,605 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:58,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:58,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:58,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:59,294 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:59,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:59,295 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:59,298 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:04,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:04,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:04,624 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:07,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:07,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:07,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:07,611 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:10,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:10,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:10,628 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:14,596 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:14,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:14,596 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:14,598 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:16,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:16,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:16,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:22,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:22,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:22,653 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:28,639 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:28,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:28,640 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:34,635 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:34,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:34,636 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:40,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:40,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:40,689 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:45,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:45,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:45,602 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:45,603 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:46,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:46,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:46,681 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:51,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:51,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:51,301 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:51,302 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:52,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:52,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:52,712 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:55,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:55,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:55,938 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:55,939 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:56,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:56,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:56,287 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:56,288 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:59,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:59,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:59,713 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:00,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:00,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:00,297 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:00,298 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:05,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:05,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:05,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:11,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:11,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:11,656 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:15,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:15,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:15,603 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:15,605 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:17,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:17,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:17,658 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:23,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:23,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:23,638 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,428 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,429 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,441 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,442 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,455 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,456 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,456 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,457 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,468 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,469 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,479 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,480 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,481 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,488 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,489 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,491 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,504 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,505 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:32,713 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:33:32,713 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 13, 3, 32, 713218), 'iat': datetime.datetime(2025, 6, 30, 12, 33, 32, 713222)}
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:33:32,713 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4OTE2MTIsImlhdCI6MTc1MTI4NjgxMn0.olIogoWFAl1IuD11BFWa6RNtA1MCy-53wW4Uezuvz4c, Expiry (seconds): 604800
2025-06-30 05:33:32,717 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,811 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,811 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,812 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,822 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,822 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,822 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,834 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,834 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,837 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,837 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,934 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,934 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,937 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,937 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,024 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,024 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:34,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:34,026 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,086 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:34,091 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:34,091 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:35,237 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:35,237 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,719 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,720 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,722 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,722 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,802 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,802 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,804 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,804 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,897 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,899 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,899 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:53,045 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:53,045 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,584 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,584 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,584 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,589 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,589 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,589 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,611 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,613 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,613 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,679 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,679 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,680 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,680 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,754 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,756 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,756 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:07,117 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:07,117 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:07,994 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:07,994 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,994 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,999 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,999 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,000 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,000 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,003 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,004 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,004 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,005 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,008 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,008 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,092 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,092 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,095 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,095 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,119 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,119 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,122 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,123 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,368 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,368 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,371 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,372 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:12,078 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:12,078 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:41,250 - WARNING - app.core.security - Access token is missing.
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:35:35,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:35:35,710 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:35:35,713 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:35:35,713 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:38:36,837 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:38:36,838 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:38:39,686 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:38:39,686 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:38:39,716 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:38:39,716 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:38:39,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:38:39,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 13, 39, 723125), 'iat': datetime.datetime(2025, 6, 30, 12, 38, 39, 723128)}
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:38:57,767 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:38:57,767 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:38:59,716 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:38:59,716 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:38:59,719 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:38:59,719 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:38:59,722 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:38:59,722 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 13, 59, 722508), 'iat': datetime.datetime(2025, 6, 30, 12, 38, 59, 722511)}
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:39:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:39:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:39:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:03,270 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:39:03,281 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:39:03,281 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:19,030 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:19,031 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:39:19,036 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:39:19,037 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:43:55,294 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:43:55,294 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:43:55,295 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:43:55,295 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:43:55,295 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:43:55,300 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:43:55,300 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:49:49,371 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:49:49,372 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:56:14,549 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:56:14,550 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:56:14,554 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:56:14,554 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:56:14,558 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:56:14,558 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:56:14,558 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:56:14,558 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 31, 14, 558602), 'iat': datetime.datetime(2025, 6, 30, 12, 56, 14, 558604)}
2025-06-30 05:56:14,559 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:56:19,929 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:56:19,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:56:19,930 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:56:19,930 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 13, 26, 19, 929588), 'iat': datetime.datetime(2025, 6, 30, 12, 56, 19, 929606)}
2025-06-30 05:56:19,931 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:56:19,932 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4OTI5NzksImlhdCI6MTc1MTI4ODE3OX0.VM3n-D9ue1RNX-JrZ0S4S9shmNZWyHAAO6_YmsDcMVs, Expiry (seconds): 604800
2025-06-30 05:56:19,936 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,027 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,027 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,028 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,028 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,033 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,034 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,034 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,046 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,050 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,050 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,051 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,053 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,053 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,068 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,069 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,229 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,229 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,236 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,236 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,448 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,448 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,449 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,449 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,449 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,456 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,456 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,698 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,698 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,706 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,707 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:26,620 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:26,621 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:48,850 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:56:48,855 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:15:53,880 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:15:53,881 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:15:53,886 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:15:53,886 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:15:53,898 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:15:53,898 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 50, 53, 898073), 'iat': datetime.datetime(2025, 6, 30, 13, 15, 53, 898076)}
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:18:05,890 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:18:05,891 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:18:16,106 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:18:16,107 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:18:16,109 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:18:16,109 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:18:16,112 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:18:16,112 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 53, 16, 112079), 'iat': datetime.datetime(2025, 6, 30, 13, 18, 16, 112082)}
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:26,650 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:26,650 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:29,079 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:29,079 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:29,082 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:29,082 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:29,089 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:29,089 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 29, 89091), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 29, 89093)}
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:33,559 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:33,560 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:35,990 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:35,990 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:36,017 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:36,018 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:36,022 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:36,022 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 36, 22257), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 36, 22260)}
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:38,170 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:38,171 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:40,592 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:40,592 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:40,595 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:40,595 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:40,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:40,599 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 40, 599366), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 40, 599368)}
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:00,964 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:23:00,965 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:23:03,289 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:23:03,290 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:23:03,302 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:23:03,302 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:23:03,306 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:03,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:03,306 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:03,306 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 58, 3, 306478), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 3, 306481)}
2025-06-30 06:23:03,307 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:10,180 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:23:10,181 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:23:12,531 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:23:12,531 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:23:12,546 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:23:12,547 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:23:12,550 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:12,550 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 58, 12, 550477), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 12, 550479)}
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:54,736 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:54,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:54,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:54,737 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 30, 13, 53, 54, 736563), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 54, 736571)}
2025-06-30 06:23:54,737 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:54,737 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTg5NDYzNCwiaWF0IjoxNzUxMjg5ODM0fQ.L1QZ-kEEtVNvsTgImE9x6FGFGL5yapYPdJhUGhGGrUU, Expiry (seconds): 604800
2025-06-30 06:23:54,738 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-30 06:26:15,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:26:15,142 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:26:15,173 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:26:15,174 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:26:15,174 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:26:15,182 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:26:15,182 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:27:15,878 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:15,879 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:18,741 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:18,741 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:18,765 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:18,766 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:18,773 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:18,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:18,773 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:18,773 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 18, 773464), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 18, 773469)}
2025-06-30 06:27:18,774 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:34,266 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:34,266 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:36,426 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:36,426 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:36,431 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:36,432 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:36,435 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:36,435 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 36, 435459), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 36, 435461)}
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:41,174 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:41,175 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:48,286 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:48,286 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:48,290 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:48,290 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:48,295 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:48,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:48,295 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:48,295 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 48, 295881), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 48, 295884)}
2025-06-30 06:27:48,296 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:54,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:27:54,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:27:54,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:27:54,772 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:27:54,773 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:27:54,786 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:27:54,786 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:28:13,285 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:28:13,286 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:28:15,548 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:28:15,548 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:28:15,557 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:28:15,557 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:28:15,561 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:28:15,561 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 3, 15, 561070), 'iat': datetime.datetime(2025, 6, 30, 13, 28, 15, 561072)}
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:28:19,952 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:28:19,952 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:28:19,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:28:19,953 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:28:19,953 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:28:19,964 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:28:19,965 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:30:10,282 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:10,284 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:12,823 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:12,823 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:12,828 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:12,829 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:12,833 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:12,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:12,833 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:12,833 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 12, 833749), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 12, 833752)}
2025-06-30 06:30:12,834 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:26,293 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:26,293 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:28,608 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:28,608 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:28,617 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:28,617 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:28,620 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:28,620 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 28, 620033), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 28, 620035)}
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:33,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:30:33,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:30:33,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:33,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:33,540 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:30:33,552 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:30:33,552 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:30:51,590 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:51,590 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:53,913 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:53,913 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:53,918 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:53,918 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:53,921 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:53,921 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 53, 921237), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 53, 921239)}
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:58,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:30:58,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:30:58,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:58,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:58,912 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:30:58,922 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:30:58,922 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:31:07,664 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:31:07,665 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:31:09,961 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:31:09,961 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:31:09,963 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:31:09,964 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:31:09,967 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:31:09,967 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 6, 9, 967208), 'iat': datetime.datetime(2025, 6, 30, 13, 31, 9, 967211)}
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:31:11,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:31:11,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:31:11,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:31:11,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:31:11,568 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:31:11,666 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:31:11,666 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:34:09,827 - WARNING - app.core.security - Access token is missing.
2025-06-30 06:34:27,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:34:27,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:34:27,310 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:34:27,310 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:34:27,310 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:34:27,314 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:34:27,314 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:35:36,042 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:35:36,043 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:35:38,913 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:35:38,913 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:35:38,919 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:35:38,919 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:35:38,923 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:35:38,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 10, 38, 923497), 'iat': datetime.datetime(2025, 6, 30, 13, 35, 38, 923499)}
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:35:49,776 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:35:49,776 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:35:52,552 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:35:52,552 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:35:52,565 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:35:52,565 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:35:52,568 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:35:52,569 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 10, 52, 568967), 'iat': datetime.datetime(2025, 6, 30, 13, 35, 52, 568970)}
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:35:54,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:35:54,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:35:54,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:35:54,198 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:35:54,198 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:35:54,312 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:35:54,312 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:36:13,537 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:36:13,538 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:36:19,651 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:36:19,651 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:36:19,655 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:36:19,655 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:36:19,658 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:36:19,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:36:19,658 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:36:19,658 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 11, 19, 658609), 'iat': datetime.datetime(2025, 6, 30, 13, 36, 19, 658612)}
2025-06-30 06:36:19,659 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:37:41,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:37:41,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:37:41,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:37:41,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:37:41,304 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:37:41,309 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:37:41,309 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:39:17,449 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:39:17,450 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:39:20,253 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:39:20,253 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:39:20,257 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:39:20,257 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:39:20,262 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:39:20,262 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 14, 20, 262567), 'iat': datetime.datetime(2025, 6, 30, 13, 39, 20, 262569)}
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:39:21,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:39:21,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:39:21,969 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:21,969 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:21,969 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:39:22,113 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:39:22,113 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:39:33,413 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:39:33,414 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:39:35,982 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:39:35,982 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:39:35,986 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:39:35,986 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:39:35,989 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:39:35,989 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:39:35,989 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:39:35,989 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 14, 35, 989840), 'iat': datetime.datetime(2025, 6, 30, 13, 39, 35, 989843)}
2025-06-30 06:39:35,990 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:39:37,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:39:37,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:39:37,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:37,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:37,912 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:39:37,921 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:39:37,921 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:40:41,696 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:40:41,696 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:40:44,656 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:40:44,657 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:40:44,662 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:40:44,662 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:40:44,668 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:40:44,668 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 15, 44, 668468), 'iat': datetime.datetime(2025, 6, 30, 13, 40, 44, 668471)}
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:40:50,814 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:40:50,815 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:40:53,519 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:40:53,519 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:40:53,522 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:40:53,522 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:40:53,525 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:40:53,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:40:53,526 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:40:53,526 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 15, 53, 525914), 'iat': datetime.datetime(2025, 6, 30, 13, 40, 53, 525917)}
2025-06-30 06:40:53,526 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:40:57,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:40:57,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:40:57,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:40:57,941 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:40:57,941 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:40:57,953 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:40:57,953 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:41:10,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:41:10,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:41:10,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:41:10,608 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:41:10,608 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:41:10,611 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:41:10,612 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 10:08:56,700 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:08:56,700 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:08:56,726 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:08:56,726 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:08:56,735 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:08:56,735 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:08:56,735 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:08:56,735 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 17, 43, 56, 735561), 'iat': datetime.datetime(2025, 6, 30, 17, 8, 56, 735564)}
2025-06-30 10:08:56,736 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:09:22,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,226 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,231 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,248 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,250 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,263 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,265 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,275 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,277 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,286 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:26,922 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:09:26,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:09:26,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:09:26,923 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 17, 39, 26, 922787), 'iat': datetime.datetime(2025, 6, 30, 17, 9, 26, 922804)}
2025-06-30 10:09:26,924 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:09:26,924 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5MDgxNjYsImlhdCI6MTc1MTMwMzM2Nn0.LdJC1RHvG8ovE30L4qIdsCeQFn5R-nuh-9eRSWggkMQ, Expiry (seconds): 604800
2025-06-30 10:09:26,929 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 10:09:28,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,033 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,033 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,034 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,034 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,039 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,040 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,040 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,057 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,063 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,063 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,064 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,077 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,077 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,379 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,383 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,383 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,383 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,394 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,394 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,396 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,397 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,397 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,397 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,411 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,411 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,711 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,743 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,744 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,749 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,749 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:10:43,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:10:43,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:10:43,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:10:43,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:10:43,581 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:10:43,585 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:10:43,585 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:11:04,788 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:11:04,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:11:04,788 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:11:04,789 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 17, 41, 4, 788643), 'iat': datetime.datetime(2025, 6, 30, 17, 11, 4, 788651)}
2025-06-30 10:11:04,789 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:11:04,789 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5MDgyNjQsImlhdCI6MTc1MTMwMzQ2NH0.Lr9BetCnlMtk2-mI8eWlOIWGgwLRwCjzvwhqrFLHn_g, Expiry (seconds): 604800
2025-06-30 10:11:04,791 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:11:16,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:11:16,658 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:11:16,664 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:11:16,665 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:11:30,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:30,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:30,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:30,242 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:11:30,244 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:59,563 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:59,563 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:11:59,567 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:11:59,567 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:12:02,526 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:12:02,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:12:02,526 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:12:02,526 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 30, 17, 42, 2, 526364), 'iat': datetime.datetime(2025, 6, 30, 17, 12, 2, 526373)}
2025-06-30 10:12:02,527 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:12:02,527 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTkwODMyMiwiaWF0IjoxNzUxMzAzNTIyfQ.7ZA6zo6bZJL04fMUoeVc6DUIS6R7Y0Gwpn7hpmlGsHU, Expiry (seconds): 604800
2025-06-30 10:12:02,529 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751305322, 'iat': 1751303522}
2025-06-30 10:12:22,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751305322, 'iat': 1751303522}
2025-06-30 10:12:22,629 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 10:12:22,633 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 10:12:22,633 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 10:12:29,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:12:29,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:12:29,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:12:29,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:12:29,486 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:12:29,490 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:12:29,490 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:13:00,471 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:13:00,471 - INFO - app.core.security - Redis connection closed.
2025-06-30 10:25:02,091 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:25:02,092 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:25:02,096 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:25:02,096 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:25:02,133 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:25:02,133 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:25:02,133 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:25:02,134 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 18, 0, 2, 133750), 'iat': datetime.datetime(2025, 6, 30, 17, 25, 2, 133754)}
2025-06-30 10:25:02,134 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:25:27,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,066 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:25:27,068 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:25:27,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,140 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,140 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,144 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,157 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,158 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:27,239 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,256 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,257 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,257 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,330 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,330 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:27,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,372 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,382 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,382 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:27,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,420 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,430 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,430 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:27,466 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,466 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,469 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,469 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,482 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,483 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:28,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:28,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:28,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:28,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:28,872 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:28,880 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:28,881 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:28,881 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:25:28,898 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:25:33,965 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:25:33,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:25:33,965 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:25:33,965 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 17, 55, 33, 965229), 'iat': datetime.datetime(2025, 6, 30, 17, 25, 33, 965239)}
2025-06-30 10:25:33,966 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:25:33,967 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5MDkxMzMsImlhdCI6MTc1MTMwNDMzM30.C8yynfMSqYRo69U4i4Rrf51TNAd1MPmjpjVZMPfTBMQ, Expiry (seconds): 604800
2025-06-30 10:25:33,972 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 10:25:35,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,267 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,268 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,268 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:25:35,268 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,269 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:35,278 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:35,279 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,279 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,292 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,292 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:25:35,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,293 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,294 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:35,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,304 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:35,308 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:35,308 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,309 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,316 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:35,317 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,656 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,657 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,657 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:35,661 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:35,662 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:36,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:36,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:36,035 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:36,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:36,165 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:36,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:36,166 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:36,166 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:36,175 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:36,175 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:37,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:37,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:37,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:37,814 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:37,815 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:37,824 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:37,826 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,150 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,150 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,150 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,150 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:26:37,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,151 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,152 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,152 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,161 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,173 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,173 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,174 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,174 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,174 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,182 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,183 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,214 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,214 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:26:37,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,215 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,215 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,223 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,223 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,224 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,794 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,802 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,803 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,935 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,936 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,937 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,965 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,966 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:38,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:38,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:38,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:38,143 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:38,146 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:38,189 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:38,189 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:38,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:38,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:38,456 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:27:30,551 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:27:30,553 - INFO - app.core.security - Redis connection closed.
2025-06-30 10:27:35,238 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:27:35,239 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:27:35,243 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:27:35,243 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:27:35,255 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:27:35,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:27:35,256 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:27:35,256 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 18, 2, 35, 255578), 'iat': datetime.datetime(2025, 6, 30, 17, 27, 35, 255591)}
2025-06-30 10:27:35,257 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:27:37,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:27:37,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:27:37,147 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:27:53,388 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:27:53,389 - INFO - app.core.security - Redis connection closed.
2025-06-30 10:27:58,115 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:27:58,115 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:27:58,119 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:27:58,119 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:27:58,124 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:27:58,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:27:58,124 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:27:58,125 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 18, 2, 58, 124851), 'iat': datetime.datetime(2025, 6, 30, 17, 27, 58, 124854)}
2025-06-30 10:27:58,125 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:28:00,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:00,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:00,348 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:00,349 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:00,349 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:00,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:00,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:00,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:00,358 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDYxMzMsImlhdCI6MTc1MTMwNDMzM30.QHroqf2O3_QVoFGqMSvdE1i-66IqCfeoFbOMV56MieU
2025-06-30 10:28:00,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:00,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:00,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:00,387 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDYxMzMsImlhdCI6MTc1MTMwNDMzM30.QHroqf2O3_QVoFGqMSvdE1i-66IqCfeoFbOMV56MieU
2025-06-30 10:28:00,793 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:00,794 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:05,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:05,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:05,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:05,763 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDYxMzMsImlhdCI6MTc1MTMwNDMzM30.QHroqf2O3_QVoFGqMSvdE1i-66IqCfeoFbOMV56MieU
2025-06-30 10:28:05,765 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDYxMzMsImlhdCI6MTc1MTMwNDMzM30.QHroqf2O3_QVoFGqMSvdE1i-66IqCfeoFbOMV56MieU
2025-06-30 10:28:09,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,452 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,452 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:28:09,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,453 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:09,467 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:09,467 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,467 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,515 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,516 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,516 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,517 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:28:09,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,517 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,518 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:09,525 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:09,525 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,525 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,537 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,537 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:09,547 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:09,547 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,843 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,843 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,844 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,844 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:09,857 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:09,857 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:10,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:10,016 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:10,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:10,017 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:10,017 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:10,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:10,026 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:10,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:10,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:10,415 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:10,415 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:10,416 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:10,425 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:10,426 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:10,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:10,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:10,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:29,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:29,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:29,340 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:29,340 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:29,340 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:29,347 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:29,347 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:29:00,046 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:29:00,049 - INFO - app.core.security - Redis connection closed.
2025-06-30 22:56:29,123 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 22:56:29,123 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 22:56:29,130 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 22:56:29,130 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 22:56:29,135 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 22:56:29,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 22:56:29,135 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 22:56:29,135 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 31, 29, 135184), 'iat': datetime.datetime(2025, 7, 1, 5, 56, 29, 135186)}
2025-06-30 22:56:29,136 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 22:56:31,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:31,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:31,283 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:56:37,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:37,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:37,231 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:56:43,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:43,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:43,208 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:56:49,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:49,209 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:49,209 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:56:55,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:55,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:55,209 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:01,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:01,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:01,220 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:05,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:05,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:05,214 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:05,216 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:07,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:07,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:07,234 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:13,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:13,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:13,219 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:14,105 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:14,106 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:14,106 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:14,108 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:19,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:19,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:19,237 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:25,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:25,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:25,203 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:25,204 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:25,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:25,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:25,217 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:31,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:31,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:31,230 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:32,928 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:32,928 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:32,929 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:32,931 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:33,384 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:33,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:33,384 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:33,386 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:37,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:37,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:37,215 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:43,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:43,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:43,237 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:49,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:49,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:49,226 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:54,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,148 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,148 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:57:54,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,149 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:54,241 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:54,241 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:54,241 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:54,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,388 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,388 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:57:54,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,388 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,389 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,389 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,389 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:54,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,432 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,432 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:54,464 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:54,464 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:54,464 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:54,705 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:54,706 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:55,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:55,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:55,227 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:55,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:55,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:55,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:55,845 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:55,845 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:57:55,845 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:55,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:55,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:55,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:55,845 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:55,943 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:55,944 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:55,944 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:56,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:56,094 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:56,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,095 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,095 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:57:56,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:56,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:56,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,095 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,095 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:56,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:56,098 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:56,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,099 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,099 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:56,191 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:56,192 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:56,192 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:56,319 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:56,319 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:00,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:00,165 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:00,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:00,167 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:00,167 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:00,275 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:00,275 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:01,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:01,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:01,219 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:06,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:06,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:06,082 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:06,082 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:06,082 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:06,150 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:06,150 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:07,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:07,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:07,221 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:09,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:09,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:09,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:09,980 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:09,980 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:09,980 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:09,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:09,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:09,981 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:09,981 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:10,126 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:10,127 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:10,128 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:10,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:10,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:10,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,242 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,242 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:10,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:10,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:10,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,243 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:10,318 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:10,318 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:10,319 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:10,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:10,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:10,499 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,501 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:10,585 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:10,586 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:13,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:13,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:13,224 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:19,251 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:19,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:19,252 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:19,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:19,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:19,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:19,814 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:19,814 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:19,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:19,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:19,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:19,814 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:19,814 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:20,031 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:20,031 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:20,032 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:20,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:20,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:20,086 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:20,089 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:20,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:20,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:20,199 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,199 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,200 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:20,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:20,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:20,200 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,201 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,201 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:20,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:20,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:20,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,207 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,207 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:20,275 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:20,275 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:20,281 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:20,281 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:20,282 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:25,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:25,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:25,237 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:26,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:26,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:26,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:26,213 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:26,214 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:26,393 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:26,393 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:27,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:27,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:27,693 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:27,694 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:27,694 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:27,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:27,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:27,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:27,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:27,694 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:27,964 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:27,965 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:27,965 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:28,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:28,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:28,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,152 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,152 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:28,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:28,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:28,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,153 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:28,158 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:28,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:28,159 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,159 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,159 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:28,238 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:28,238 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:28,238 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:28,247 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:28,247 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:31,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:31,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:31,238 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:32,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:32,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:32,215 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:32,217 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:34,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:34,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:34,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:34,838 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:34,838 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:34,926 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:34,926 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:36,476 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:36,476 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:36,477 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:36,480 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:37,227 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:37,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:37,228 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:38,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:38,915 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:38,915 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:38,919 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:40,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:40,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:40,739 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:40,740 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:40,740 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:40,833 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:40,833 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:43,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:43,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:43,224 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:49,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:49,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:49,219 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:49,221 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:49,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:49,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:49,230 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:55,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:55,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:55,213 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:01,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:01,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:01,225 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:07,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:07,218 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:07,218 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:13,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:13,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:13,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:13,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:13,046 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:13,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:13,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:13,242 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:13,301 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:13,302 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:18,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:18,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:18,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:18,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:18,057 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:18,126 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:18,126 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:19,235 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:19,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:19,236 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:25,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:25,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:25,258 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:29,276 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:29,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:29,277 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:29,277 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:29,277 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:29,349 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:29,350 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:31,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:31,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:31,242 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:31,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:31,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:31,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:31,443 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:31,444 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:31,576 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:31,576 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:34,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:34,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:34,904 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:34,905 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:59:37,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:37,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:37,233 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:40,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:40,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:40,773 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:40,775 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:59:43,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:43,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:43,606 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:45,186 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:45,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:45,187 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,187 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,187 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:59:45,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:45,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:45,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,188 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:45,258 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:45,258 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:45,258 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:45,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:45,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:45,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,291 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,291 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:59:45,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:45,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:45,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,292 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,292 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:45,371 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:45,371 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:45,371 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,135 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,135 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:59:46,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,139 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,139 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:46,202 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:46,202 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,209 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,301 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,301 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,302 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,302 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:46,364 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:46,364 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,364 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,429 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,429 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:46,506 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:46,506 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:47,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:47,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:47,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:47,906 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:59:49,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:49,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:49,238 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:50,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:50,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:50,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:50,398 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:50,398 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:50,509 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:50,509 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:53,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:53,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:53,901 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:53,904 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:59:55,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:55,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:55,216 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:56,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:56,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:56,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:56,632 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:56,632 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:56,749 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:56,749 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:01,222 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:01,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:01,222 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:05,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:05,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:05,206 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:05,207 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:00:07,249 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:07,249 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:07,250 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:13,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:13,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:13,216 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:19,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:19,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:19,232 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:25,264 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:25,264 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:25,265 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:31,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:31,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:31,231 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:37,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:37,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:37,243 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:40,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:40,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:40,210 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:40,211 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:00:43,239 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:43,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:43,240 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:46,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:46,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:46,067 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:46,078 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:00:49,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:49,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:49,213 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:53,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:53,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:53,210 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:53,211 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,046 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,046 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,046 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:55,113 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:55,114 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:55,114 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,185 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,185 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,185 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,185 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:55,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,225 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:55,252 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:55,252 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:55,252 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:56,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:56,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:56,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:56,115 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:56,115 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:56,255 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:56,256 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:59,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:59,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:59,674 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,674 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,675 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:00:59,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:59,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:59,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,675 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:59,747 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:59,747 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:59,747 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,817 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,817 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:59,818 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,818 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,818 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:59,894 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:59,894 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:59,894 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:00,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:00,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:00,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:00,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:00,016 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:00,100 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:00,100 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:01,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:01,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:01,236 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:04,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:04,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:04,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:04,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:04,946 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:05,013 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:05,013 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:05,259 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:05,259 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:05,260 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:05,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:05,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:05,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:05,416 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:05,417 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:05,531 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:05,531 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:06,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:06,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:06,203 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:06,204 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:07,211 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:07,211 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:07,211 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:08,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:08,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:08,900 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:08,900 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:09,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:09,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:09,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:09,904 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:10,193 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,193 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,194 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,194 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:01:10,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,194 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,194 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:10,294 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:10,294 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:10,294 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:10,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,360 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,361 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,361 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:01:10,361 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,361 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,362 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:10,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,365 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,365 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,366 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:10,425 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:10,425 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:10,425 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:10,845 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:10,845 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:13,227 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:13,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:13,228 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:16,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:16,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:16,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:16,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:16,849 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:16,919 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:16,920 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:17,160 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:17,160 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:17,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:21,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:21,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:21,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:21,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:21,897 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:21,967 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:21,967 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:27,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:27,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:27,183 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:32,481 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:32,482 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:32,482 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:42,506 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:42,507 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:42,507 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:48,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:48,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:48,204 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:50,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:50,096 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:50,096 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:50,097 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:57,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:57,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:57,252 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:57,257 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:58,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:58,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:58,225 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:04,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:04,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:04,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:02:08,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:08,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:08,900 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:08,902 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:02:12,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:12,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:12,896 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:12,898 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:02:14,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:14,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:14,243 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:20,204 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:20,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:20,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:02:21,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:21,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:21,210 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:21,212 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:02:25,901 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:25,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:25,901 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:25,902 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:02:30,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:30,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:30,234 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:36,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:36,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:36,202 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:36,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:36,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:36,224 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:02:46,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:46,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:46,255 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:52,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:52,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:52,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:02:56,108 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:56,108 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:56,108 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:56,109 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:02,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:02,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:02,231 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:08,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:08,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:08,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:03:14,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:14,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:14,222 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:14,224 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:15,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:15,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:15,893 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:15,894 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:18,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:18,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:18,224 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:24,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:24,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:24,214 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:24,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:24,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:24,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:03:24,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:24,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:24,906 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:24,906 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:34,253 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:34,253 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:34,253 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:37,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:37,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:37,215 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:37,216 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:40,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:40,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:40,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:03:44,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:44,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:44,904 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:44,905 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:50,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:50,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:50,254 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:56,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:56,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:56,198 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:04:00,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:00,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:00,313 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:00,314 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:06,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:06,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:06,227 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:12,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:12,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:12,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:04:19,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:19,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:19,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:19,904 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:22,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:22,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:22,248 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:28,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:28,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:28,202 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:28,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:28,218 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:28,218 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:04:30,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:30,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:30,363 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:30,363 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:38,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:38,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:38,241 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:41,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:41,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:41,902 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:41,903 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:44,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:44,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:44,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:04:54,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:54,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:54,207 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:54,208 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:54,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:54,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:54,225 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:00,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:00,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:00,217 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:00,326 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:00,326 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:00,326 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:05:00,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:00,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:00,892 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:00,893 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:03,012 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:03,012 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:03,013 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:03,014 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:10,359 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:10,359 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:10,359 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:16,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:16,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:16,201 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:16,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:16,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:16,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:05:22,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:22,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:22,555 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:22,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:22,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:22,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:23,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:23,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:23,147 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:23,149 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:27,891 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:27,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:27,892 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,272 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,273 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,280 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,282 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,287 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,288 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,295 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,297 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,305 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,306 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,307 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,316 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,321 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:34,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:34,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:34,206 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:40,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:40,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:40,213 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:46,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:46,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:46,206 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:46,972 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:05:46,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:05:46,973 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:05:46,973 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 35, 46, 972827), 'iat': datetime.datetime(2025, 7, 1, 6, 5, 46, 972832)}
2025-06-30 23:05:46,973 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:05:46,973 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTQ3NDYsImlhdCI6MTc1MTM0OTk0Nn0.DqQ0x2vQSy96qFWJrwK4D14BCytlRwH_QmHZyBzq_sA, Expiry (seconds): 604800
2025-06-30 23:05:46,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:46,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:46,974 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:46,975 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:46,979 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:05:48,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,290 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,290 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,290 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,290 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:48,389 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:48,389 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,389 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,450 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,450 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:48,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,557 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,557 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:05:48,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,557 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,557 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:48,575 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:48,575 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,620 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:48,621 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,621 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,739 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,740 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,740 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:48,822 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:48,822 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:52,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:52,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:52,211 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:54,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:54,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:54,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:54,039 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:54,039 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:54,093 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:54,093 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:54,350 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:54,350 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:54,351 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:57,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:57,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:57,899 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:57,900 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:06:00,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:00,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:00,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:06:00,232 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:06:00,232 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:00,295 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:00,295 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:04,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:04,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:04,378 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:06,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:06,389 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:06,389 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:06,390 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:06:09,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:09,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:09,896 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:09,897 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:06:12,816 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:06:12,817 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:06:19,959 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:06:19,959 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:06:19,962 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:06:19,962 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:06:19,981 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:06:19,981 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:06:19,981 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:06:19,981 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 41, 19, 981520), 'iat': datetime.datetime(2025, 7, 1, 6, 6, 19, 981523)}
2025-06-30 23:06:19,982 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:06:22,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:22,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:22,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:26,563 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:26,563 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:26,563 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:06:28,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:28,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:28,207 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:28,207 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:06:36,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:36,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:36,595 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:42,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:42,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:42,204 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:48,309 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:06:48,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:06:48,310 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:06:48,310 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 36, 48, 309844), 'iat': datetime.datetime(2025, 7, 1, 6, 6, 48, 309851)}
2025-06-30 23:06:48,310 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:06:48,310 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTQ4MDgsImlhdCI6MTc1MTM1MDAwOH0.0ZMuGTWlB5luzoeZhPZSCCmXqj5BgGHBPZ8KEbfMgds, Expiry (seconds): 604800
2025-06-30 23:06:48,313 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:06:48,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:48,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:48,317 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:49,572 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:49,572 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:49,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,573 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,573 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:06:49,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:49,574 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:49,574 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,574 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,574 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:49,684 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:49,684 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:49,685 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:49,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:49,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:49,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,774 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,774 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:06:49,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:49,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:49,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,775 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,775 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:49,895 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:49,896 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:49,896 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:50,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:50,082 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:50,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:50,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:50,083 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:50,308 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:50,308 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:51,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:51,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:51,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:51,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:51,733 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:51,869 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:51,869 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:54,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:54,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:54,218 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:56,379 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:56,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:56,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:56,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:56,380 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:56,480 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:56,481 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:56,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:56,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:56,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:04,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:04,078 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:04,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:04,078 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:04,078 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:07:04,331 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:07:04,331 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:07:04,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:04,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:04,904 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:04,904 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:06,717 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:06,717 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:06,717 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:10,364 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:10,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:10,364 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:10,366 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:12,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:12,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:12,214 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:12,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:12,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:12,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:13,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:13,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:13,897 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:13,899 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:22,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:22,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:22,269 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:24,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:24,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:24,897 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:24,898 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:28,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:28,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:28,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:33,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:33,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:33,201 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:33,202 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:33,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:33,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:33,899 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:33,900 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:38,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:38,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:38,233 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:44,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:44,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:44,200 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:44,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:44,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:44,216 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:54,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:54,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:54,248 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:00,093 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:00,094 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:00,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:00,096 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE4MDgsImlhdCI6MTc1MTM1MDAwOH0.3OxV9jzlh5qvzaqpebpkqgx1ith-d-SYsLlw1zzGYOI
2025-06-30 23:08:00,097 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE4MDgsImlhdCI6MTc1MTM1MDAwOH0.3OxV9jzlh5qvzaqpebpkqgx1ith-d-SYsLlw1zzGYOI
2025-06-30 23:08:00,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:00,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:00,223 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:05,729 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:05,729 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:05,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:05,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:05,733 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:05,939 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:05,940 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:09,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:09,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:09,787 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:09,942 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:09,943 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:09,943 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:09,943 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:09,943 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:08:09,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:09,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:09,944 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:09,945 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:09,945 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:10,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:10,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:10,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,025 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:10,097 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:10,101 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,101 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,256 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:10,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:10,257 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,257 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,261 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:08:10,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:10,261 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:10,263 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,263 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,263 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:10,351 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:10,353 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,353 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,454 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:10,455 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,574 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:10,574 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:10,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,575 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,575 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:10,658 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:10,659 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:17,287 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:08:17,290 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:08:20,103 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:08:20,104 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:08:20,106 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:08:20,106 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:08:20,110 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:08:20,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:08:20,110 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:08:20,110 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 43, 20, 110197), 'iat': datetime.datetime(2025, 7, 1, 6, 8, 20, 110200)}
2025-06-30 23:08:20,110 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:08:21,869 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,869 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,870 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:21,872 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:21,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,877 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:21,877 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:21,877 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:21,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,883 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,883 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:21,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,896 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:21,897 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:21,901 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,901 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:22,781 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:22,781 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:28,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:28,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:28,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:28,835 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:28,836 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:29,384 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:29,384 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:31,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:31,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:31,921 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:32,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:32,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:32,284 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:32,286 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:36,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:36,894 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:36,894 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:36,896 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:38,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:38,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:38,208 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:38,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:38,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:38,892 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:38,893 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:48,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:48,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:48,238 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:48,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:48,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:48,898 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:48,899 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:54,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:54,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:54,220 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:09:00,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:00,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:00,227 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:09:00,707 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:09:00,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:09:00,708 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:09:00,708 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 39, 0, 707909), 'iat': datetime.datetime(2025, 7, 1, 6, 9, 0, 707915)}
2025-06-30 23:09:00,708 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:09:00,709 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTQ5NDAsImlhdCI6MTc1MTM1MDE0MH0.2GqmNoYh47Gy3DbOwN3l9b0gBjVg8S8wFVRiAZOgBW8, Expiry (seconds): 604800
2025-06-30 23:09:00,714 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:09:02,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,114 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,114 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,114 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,115 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:02,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,116 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,116 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:02,204 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:02,204 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:02,205 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:02,324 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,325 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,325 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,325 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:02,325 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,325 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,326 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,326 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,326 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:02,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,330 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:02,389 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:02,389 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:02,389 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:02,713 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:02,714 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:04,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:04,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:04,366 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:04,366 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:04,367 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:04,537 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:04,537 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:06,222 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:06,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:06,222 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:09:10,486 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:10,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:10,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:10,487 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:10,488 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:10,545 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:10,545 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:10,796 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:10,796 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:10,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:16,012 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:16,012 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:16,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:16,012 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:16,012 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:16,065 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:16,065 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,369 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,369 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,370 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,370 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:35,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,371 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:35,492 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:35,492 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,492 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,675 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,675 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:35,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,677 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,677 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,677 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:35,792 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:35,793 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,793 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,946 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:36,076 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:36,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:37,524 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:37,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:37,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:37,526 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:37,526 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:37,582 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:37,583 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:40,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:40,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:40,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:40,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:40,371 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:40,597 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:40,597 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:40,598 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE5NDAsImlhdCI6MTc1MTM1MDE0MH0.ntZYTERvPT4l31vj8BGuvfl0YhNIgABQoLZsVC4YMUI
2025-06-30 23:09:40,616 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE5NDAsImlhdCI6MTc1MTM1MDE0MH0.ntZYTERvPT4l31vj8BGuvfl0YhNIgABQoLZsVC4YMUI
2025-06-30 23:09:53,289 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:09:53,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:09:53,290 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:09:53,290 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 39, 53, 289869), 'iat': datetime.datetime(2025, 7, 1, 6, 9, 53, 289875)}
2025-06-30 23:09:53,290 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:09:53,290 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTQ5OTMsImlhdCI6MTc1MTM1MDE5M30.w5PkMd7l1Tf6Z46y7JiLlmPeEZPxR9BDjZ5co09dbx8, Expiry (seconds): 604800
2025-06-30 23:09:53,294 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:09:54,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:54,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:54,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,535 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,535 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:54,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:54,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:54,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,536 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:54,732 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:54,732 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:54,732 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:54,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:54,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:54,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,923 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,923 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:54,924 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:54,924 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:54,924 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,925 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,925 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:54,989 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:54,989 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:54,990 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:55,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:55,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:55,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:55,238 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:55,238 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:55,343 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:55,343 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:56,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:56,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:56,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:56,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:56,865 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:56,934 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:56,934 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:10:02,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:02,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:02,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:02,398 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:02,398 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:10:02,502 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:10:02,502 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:10:02,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:02,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:02,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:10,603 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:10,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:10,604 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:10,604 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:10,605 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:10:10,805 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:10:10,805 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:10:18,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:18,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:18,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:33,354 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:33,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:33,354 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:49,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:49,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:49,227 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:53,543 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:10:53,546 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:11:43,745 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:11:43,745 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:11:43,748 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:11:43,749 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:11:43,784 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:11:43,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:11:43,784 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:11:43,784 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 46, 43, 784235), 'iat': datetime.datetime(2025, 7, 1, 6, 11, 43, 784237)}
2025-06-30 23:11:43,784 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:12:04,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,192 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,192 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:04,192 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,192 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,192 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,193 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,194 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,194 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,197 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,197 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,197 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,206 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,207 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:04,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,207 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,207 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,208 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,208 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,211 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,211 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,211 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,416 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,416 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,418 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,418 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,611 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,614 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,614 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,710 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,714 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,714 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,927 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,927 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,927 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:06,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:06,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:06,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:06,404 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:06,404 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:06,407 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:06,408 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:06,408 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE5OTMsImlhdCI6MTc1MTM1MDE5M30.hXM_cgg0KhTYGTAx4-LL2iPhnBVXO4VGuCnR2s-1x-E
2025-06-30 23:12:06,409 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE5OTMsImlhdCI6MTc1MTM1MDE5M30.hXM_cgg0KhTYGTAx4-LL2iPhnBVXO4VGuCnR2s-1x-E
2025-06-30 23:12:21,227 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:12:21,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:12:21,227 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:12:21,227 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 42, 21, 227145), 'iat': datetime.datetime(2025, 7, 1, 6, 12, 21, 227153)}
2025-06-30 23:12:21,229 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:12:21,229 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTUxNDEsImlhdCI6MTc1MTM1MDM0MX0.bVWa6rHd2dwAkuIzBgRnL3KlS5Tr4LH7qE_lwglY7og, Expiry (seconds): 604800
2025-06-30 23:12:21,230 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,310 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,310 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,311 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,311 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,314 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,314 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,314 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,321 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,321 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,321 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:22,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,321 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,321 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,321 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,323 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,323 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,323 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,339 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,340 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,340 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,340 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,342 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,343 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,438 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,440 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,440 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,530 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,530 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,530 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,532 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,532 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,597 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,598 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,598 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,598 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,605 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,605 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,757 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,633 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,634 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:54,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,634 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,636 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,636 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,636 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,640 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,640 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,640 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,641 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:54,641 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,641 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,641 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,641 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,643 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,643 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,643 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,645 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,645 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,645 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,645 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,645 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,647 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,648 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,740 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,740 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,742 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,742 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,836 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,836 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,837 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,837 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:55,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:55,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:55,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:58,971 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:58,971 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:58,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:58,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:58,971 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:58,976 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:58,976 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:58,977 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTIxNDEsImlhdCI6MTc1MTM1MDM0MX0.S72f1gtil10rgQEyuNEUjeqeW-PgZMYoE9xd_6Pqz9Q
2025-06-30 23:12:58,977 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTIxNDEsImlhdCI6MTc1MTM1MDM0MX0.S72f1gtil10rgQEyuNEUjeqeW-PgZMYoE9xd_6Pqz9Q
2025-06-30 23:15:44,404 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:15:44,405 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:15:47,090 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:15:47,091 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:15:47,093 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:15:47,093 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:15:47,097 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:15:47,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:15:47,097 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:15:47,097 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 50, 47, 96998), 'iat': datetime.datetime(2025, 7, 1, 6, 15, 47, 97000)}
2025-06-30 23:15:47,097 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:16:02,634 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:16:02,635 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:16:04,868 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:16:04,868 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:16:04,870 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:16:04,870 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:16:04,873 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:16:04,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:16:04,873 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:16:04,873 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 51, 4, 873777), 'iat': datetime.datetime(2025, 7, 1, 6, 16, 4, 873779)}
2025-06-30 23:16:04,874 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:17:15,648 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:17:15,650 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:17:48,657 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:17:48,658 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:17:48,660 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:17:48,660 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:17:48,664 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:17:48,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:17:48,664 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:17:48,664 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 52, 48, 664073), 'iat': datetime.datetime(2025, 7, 1, 6, 17, 48, 664075)}
2025-06-30 23:17:48,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:17:58,585 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:17:58,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:17:58,585 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:17:58,585 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 6, 47, 58, 585025), 'iat': datetime.datetime(2025, 7, 1, 6, 17, 58, 585032)}
2025-06-30 23:17:58,585 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:17:58,586 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NTU0NzgsImlhdCI6MTc1MTM1MDY3OH0.__Tl4MPTC-Oypnu7weKncgT-l_wxSqDzCoBcmzIJj5U, Expiry (seconds): 604800
2025-06-30 23:17:58,588 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 23:17:59,800 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,801 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,801 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,801 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:17:59,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,802 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,802 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:17:59,807 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:17:59,807 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:17:59,807 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:17:59,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,814 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,814 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:17:59,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,815 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,815 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:17:59,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,818 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,818 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,818 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:17:59,836 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:17:59,836 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:17:59,836 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:17:59,851 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:17:59,851 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:18:00,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:18:00,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:18:00,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:00,148 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:00,148 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:18:00,152 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:18:00,153 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:18:00,382 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:18:00,383 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:18:00,383 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:00,383 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:00,383 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:18:00,388 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:18:00,388 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:18:00,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:18:00,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:18:00,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:53,843 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:18:53,846 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:21:31,132 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:21:31,132 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:21:31,135 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:21:31,135 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:21:31,138 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:21:31,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:21:31,138 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:21:31,138 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 56, 31, 138672), 'iat': datetime.datetime(2025, 7, 1, 6, 21, 31, 138674)}
2025-06-30 23:21:31,139 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:21:38,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:21:38,221 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:21:38,222 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:22:52,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:22:52,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:22:52,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352735, 'iat': 1751350935}
2025-06-30 23:22:52,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352735, 'iat': 1751350935}
2025-06-30 23:22:52,303 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:22:52,307 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:22:52,307 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:24:20,495 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:24:20,497 - INFO - app.core.security - Redis connection closed.
2025-07-01 02:20:23,957 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 02:20:23,957 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 02:20:23,959 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 02:20:23,959 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 02:20:23,965 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 02:20:23,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 02:20:23,965 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 02:20:23,965 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 9, 55, 23, 965885), 'iat': datetime.datetime(2025, 7, 1, 9, 20, 23, 965888)}
2025-07-01 02:20:23,966 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 02:20:34,617 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 02:20:34,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 02:20:34,618 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 02:20:34,618 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 9, 50, 34, 617284), 'iat': datetime.datetime(2025, 7, 1, 9, 20, 34, 617300)}
2025-07-01 02:20:34,619 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 02:20:34,620 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NjY0MzQsImlhdCI6MTc1MTM2MTYzNH0.xdxqzSUmlJleF7QS_-srmBIsy-G4SSxESMU9-CZSIJM, Expiry (seconds): 604800
2025-07-01 02:20:34,625 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 02:20:35,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:35,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:35,783 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,784 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,784 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:20:35,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:35,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:35,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,784 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,784 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:20:35,789 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:20:35,790 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:20:35,790 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:20:35,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:35,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:35,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,803 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,803 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:20:35,803 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:35,803 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:35,804 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,804 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,804 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:20:35,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:35,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:35,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:35,808 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:20:35,816 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:20:35,816 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:20:35,816 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:20:35,828 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:20:35,828 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:20:36,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:36,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:36,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:36,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:36,033 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:20:36,037 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:20:36,037 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:20:36,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:36,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:36,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:36,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:36,258 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:20:36,263 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:20:36,264 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:20:36,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:36,347 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:36,347 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:38,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:20:38,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:20:38,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:38,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:20:38,282 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:20:38,287 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:20:38,287 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:25:41,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:25:41,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:25:41,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:25:41,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:25:41,634 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:25:41,639 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:25:41,639 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:25:41,909 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:25:41,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:25:41,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:25:41,910 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:25:41,910 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:25:41,914 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:25:41,914 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:25:41,936 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:25:41,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:25:41,937 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:25:41,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:25:41,937 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:25:41,947 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:25:41,947 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:25:42,458 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:25:42,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:25:42,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:20,895 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:20,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,896 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,896 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:26:20,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:20,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:20,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,896 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,896 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:20,899 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:20,899 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:20,899 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:20,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:20,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:20,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,910 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,910 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:26:20,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:20,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:20,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,910 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,911 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:20,913 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:20,914 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:20,914 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:20,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:20,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:20,918 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,918 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:20,919 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:20,921 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:20,921 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:21,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:21,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:21,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:21,049 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:21,049 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:21,052 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:21,052 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:21,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:21,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:21,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:21,192 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:21,192 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:21,194 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:21,194 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:21,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:21,366 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:21,366 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:27,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:27,625 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,625 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,625 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:26:27,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:27,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:27,625 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,625 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,625 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:27,628 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:27,628 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:27,628 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:27,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:27,632 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:27,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,633 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,633 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:26:27,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:27,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:27,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,633 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,633 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:27,635 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:27,635 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:27,635 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:27,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:27,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:27,636 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,636 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,636 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:27,638 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:27,638 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:27,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:27,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:27,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,726 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,726 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:27,728 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:27,728 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:27,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:27,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:27,813 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,813 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:27,813 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:27,815 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:27,815 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:28,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:28,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:28,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:32,555 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:32,555 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:32,556 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:32,556 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:32,556 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:32,558 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:32,558 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:36,594 - WARNING - app.core.security - Access token is missing.
2025-07-01 02:26:46,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:46,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:46,781 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:46,781 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:46,781 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:46,787 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:46,788 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:47,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:47,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:47,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:47,015 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:47,015 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:47,020 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:47,021 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:47,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:47,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:47,558 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:47,558 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:47,558 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:47,563 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:47,563 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:47,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:47,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:47,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:48,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:26:48,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:26:48,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:48,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363434, 'iat': 1751361634}
2025-07-01 02:26:48,897 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:26:48,900 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:26:48,900 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:26:48,901 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjM0MzQsImlhdCI6MTc1MTM2MTYzNH0.0Fm72nhaWwZmTWTmWeyEXU2FHNhwHQCP0y81mstI5kE
2025-07-01 02:26:48,902 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjM0MzQsImlhdCI6MTc1MTM2MTYzNH0.0Fm72nhaWwZmTWTmWeyEXU2FHNhwHQCP0y81mstI5kE
2025-07-01 02:27:03,011 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 02:27:03,011 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 02:27:03,011 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 02:27:03,011 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 9, 57, 3, 11225), 'iat': datetime.datetime(2025, 7, 1, 9, 27, 3, 11233)}
2025-07-01 02:27:03,011 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 02:27:03,012 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NjY4MjMsImlhdCI6MTc1MTM2MjAyM30.aPolmHzMYh9qjtaXXBOzPyzRC0soDmU8vO6ARtAPB88, Expiry (seconds): 604800
2025-07-01 02:27:03,012 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 02:27:04,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:04,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:04,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,137 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,137 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:27:04,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:04,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:04,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,137 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,137 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:27:04,140 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:27:04,140 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:27:04,141 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:27:04,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:04,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:04,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,149 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,149 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:27:04,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:04,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:04,150 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,150 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,150 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:27:04,154 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:27:04,155 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:27:04,155 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:27:04,156 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:04,156 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:04,156 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,157 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,157 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:27:04,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:27:04,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:27:04,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:04,337 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:04,337 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,338 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,338 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:27:04,342 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:27:04,342 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:27:04,677 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:04,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:04,678 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,678 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:04,678 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:27:04,681 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:27:04,681 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:27:04,950 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:04,950 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:04,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:06,620 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:27:06,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:27:06,621 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:06,621 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:27:06,621 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:27:06,623 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:27:06,623 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:27:10,414 - WARNING - app.core.security - Access token is missing.
2025-07-01 02:28:35,490 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:28:35,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:28:35,491 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:35,491 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:35,491 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:28:35,496 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:28:35,497 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:28:35,867 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:28:35,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:28:35,868 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:35,868 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:35,868 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:28:35,872 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:28:35,873 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:28:36,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:28:36,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:28:36,199 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:36,199 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:36,199 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:28:36,203 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:28:36,203 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:28:36,354 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:28:36,355 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:28:36,355 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:39,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:28:39,094 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:28:39,094 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:39,094 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:28:39,094 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:28:39,100 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:28:39,101 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:29:27,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:29:27,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:29:27,755 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:29:27,755 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:29:27,755 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:29:27,760 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:29:27,761 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:47:54,272 - INFO - app.core.security - Closing Redis connection...
2025-07-01 02:47:54,272 - INFO - app.core.security - Redis connection closed.
2025-07-01 02:48:00,502 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 02:48:00,502 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 02:48:00,505 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 02:48:00,505 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 02:48:00,509 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 02:48:00,510 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 02:48:00,510 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 02:48:00,510 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 23, 0, 509945), 'iat': datetime.datetime(2025, 7, 1, 9, 48, 0, 509948)}
2025-07-01 02:48:00,510 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 02:48:03,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:03,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:03,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:48:03,791 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:48:03,791 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:48:03,797 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:48:03,797 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:48:03,939 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:03,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:03,940 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:48:03,940 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751363823, 'iat': 1751362023}
2025-07-01 02:48:03,940 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 02:48:03,945 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 02:48:03,946 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 02:48:11,206 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 02:48:11,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 02:48:11,207 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 02:48:11,207 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 10, 18, 11, 206558), 'iat': datetime.datetime(2025, 7, 1, 9, 48, 11, 206569)}
2025-07-01 02:48:11,207 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 02:48:11,207 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjgwOTEsImlhdCI6MTc1MTM2MzI5MX0.BnYztBN81ZdSNgCkohmSU062E70Q2Lw3YzajeWyHykA, Expiry (seconds): 604800
2025-07-01 02:48:11,209 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-01 02:48:12,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:12,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:12,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,440 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,440 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:48:12,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:12,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:12,441 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,441 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,441 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:48:12,449 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:48:12,449 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:12,449 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:12,462 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:12,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:12,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,463 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,463 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:48:12,463 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:12,463 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:12,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,464 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,464 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:48:12,470 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:48:12,470 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:12,470 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:12,475 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:12,475 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:12,475 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,475 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,476 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:48:12,490 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:48:12,490 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:12,941 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:12,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:12,942 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,942 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:12,942 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:48:12,948 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:48:12,948 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:13,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:13,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:13,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:13,421 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:13,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:13,422 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:13,422 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:13,422 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:48:13,435 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:48:13,435 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:18,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:18,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:18,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:18,135 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:18,135 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:48:18,140 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:48:18,140 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:21,788 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:21,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:21,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:21,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:21,789 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:48:21,795 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:48:21,796 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:25,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:48:25,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:48:25,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:25,662 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:48:25,663 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:48:25,667 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:48:25,667 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:48:33,373 - INFO - app.core.security - Closing Redis connection...
2025-07-01 02:48:33,374 - INFO - app.core.security - Redis connection closed.
2025-07-01 02:52:14,855 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 02:52:14,855 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 02:52:14,859 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 02:52:14,859 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 02:52:14,862 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 02:52:14,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 02:52:14,862 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 02:52:14,862 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 27, 14, 862458), 'iat': datetime.datetime(2025, 7, 1, 9, 52, 14, 862459)}
2025-07-01 02:52:14,862 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 02:52:24,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:24,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:24,035 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,035 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,035 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:52:24,035 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:24,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:24,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,036 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:24,040 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:24,040 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:24,040 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:24,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:24,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:24,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,062 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,062 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:52:24,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:24,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:24,063 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,063 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,063 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:24,068 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:24,069 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:24,069 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:24,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:24,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:24,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,075 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,075 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:24,092 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:24,093 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:24,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:24,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:24,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,320 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,320 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:24,324 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:24,325 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:24,603 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:24,603 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:24,604 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,604 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:24,604 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:24,607 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:24,607 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:24,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:24,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:24,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:35,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:35,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,066 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,066 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:52:35,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:35,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:35,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,067 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:35,072 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:35,072 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:35,072 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:35,704 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:35,704 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:35,705 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,705 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,705 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:52:35,705 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:35,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:35,705 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,705 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:35,705 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:35,708 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:35,709 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:35,709 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:36,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:36,345 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:36,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:36,346 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:36,346 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:52:36,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:36,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:36,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:36,346 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:36,346 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:36,354 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:36,354 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:36,354 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:41,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:41,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:41,614 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:41,614 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:41,614 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:41,619 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:41,619 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:45,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:45,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:45,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:45,601 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:45,602 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:45,607 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:45,608 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:48,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:48,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:48,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:48,816 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:48,816 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:48,821 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:48,822 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:54,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:52:54,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:52:54,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:54,370 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365091, 'iat': 1751363291}
2025-07-01 02:52:54,370 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:52:54,380 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:52:54,380 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:52:54,380 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNjUwOTEsImlhdCI6MTc1MTM2MzI5MX0.Ad1cbNRZW2WpJzbLRuo__zZruNV5X6eXr4KqehVQczY
2025-07-01 02:52:54,382 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNjUwOTEsImlhdCI6MTc1MTM2MzI5MX0.Ad1cbNRZW2WpJzbLRuo__zZruNV5X6eXr4KqehVQczY
2025-07-01 02:53:14,984 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 02:53:14,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 02:53:14,985 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 02:53:14,985 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 10, 23, 14, 984504), 'iat': datetime.datetime(2025, 7, 1, 9, 53, 14, 984517)}
2025-07-01 02:53:14,986 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 02:53:14,986 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjgzOTQsImlhdCI6MTc1MTM2MzU5NH0.thtB8DXScKb9osjVGqgjmRwfbVXnVO9Nit9QlfdtEzg, Expiry (seconds): 604800
2025-07-01 02:53:14,993 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-01 02:53:16,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:16,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:16,089 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,089 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,089 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:53:16,089 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:16,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:16,090 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,090 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,090 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:16,094 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:16,094 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:16,094 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:16,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:16,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:16,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,100 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,100 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:53:16,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:16,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:16,101 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,101 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,101 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:16,105 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:16,105 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:16,106 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:16,118 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:16,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:16,119 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,119 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,119 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:16,124 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:16,125 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:16,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:16,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:16,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,814 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:16,814 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:16,822 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:16,822 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:17,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:17,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:17,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:17,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:17,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:17,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:17,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:17,486 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:17,500 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:17,500 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:23,153 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:23,153 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:23,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:23,153 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:23,153 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:53:23,154 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:23,154 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:23,154 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:23,154 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:23,154 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:23,158 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:23,159 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:23,159 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:23,763 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:23,763 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:23,764 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:23,764 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:23,764 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:53:23,765 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:23,765 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:23,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:23,765 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:23,765 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:23,770 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:23,770 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:23,771 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:24,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:24,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:24,378 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:24,378 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:24,378 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:53:24,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:24,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:24,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:24,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:24,379 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:24,389 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:24,389 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:24,389 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:29,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:29,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:29,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:29,139 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:29,139 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:29,144 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:29,144 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:32,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:32,632 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:32,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:32,633 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:32,633 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:32,637 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:32,638 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:39,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:39,409 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:39,410 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:39,410 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:39,411 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:53:39,411 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:39,411 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:39,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:39,413 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:39,413 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:39,418 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:39,418 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:39,419 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:39,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:39,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:39,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:39,980 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:39,980 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:53:39,980 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:39,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:39,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:39,981 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:39,981 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:39,986 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:39,986 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:39,986 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:56,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:56,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:56,239 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:56,239 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:56,239 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 02:53:56,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:56,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:56,240 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:56,240 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:56,240 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:56,252 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:56,253 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:56,253 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:53:59,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:53:59,111 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:53:59,112 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:59,112 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:53:59,113 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:53:59,126 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:53:59,127 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:54:01,987 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 02:54:01,987 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 02:54:01,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:54:01,987 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 02:54:01,987 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 02:54:01,992 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 02:54:01,992 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 02:54:12,366 - INFO - app.core.security - Closing Redis connection...
2025-07-01 02:54:12,366 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:02:29,420 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:02:29,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:02:29,421 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:02:29,421 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 37, 29, 420921), 'iat': datetime.datetime(2025, 7, 1, 10, 2, 29, 420924)}
2025-07-01 03:02:29,421 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:02:36,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:36,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:36,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365394, 'iat': 1751363594}
2025-07-01 03:02:47,648 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:02:47,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:02:47,648 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:02:47,648 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 10, 32, 47, 648036), 'iat': datetime.datetime(2025, 7, 1, 10, 2, 47, 648051)}
2025-07-01 03:02:47,648 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:02:47,649 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njg5NjcsImlhdCI6MTc1MTM2NDE2N30.hGlsdXbJ1isCEKgf82TjM6X0coXWfIPtDNkSvbo6QVY, Expiry (seconds): 604800
2025-07-01 03:02:47,654 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-01 03:02:48,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:48,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:48,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,792 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,792 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:02:48,792 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:48,792 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:48,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,793 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,793 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:02:48,799 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:02:48,799 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:02:48,800 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:02:48,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:48,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:48,809 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,809 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,810 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:02:48,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:48,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:48,811 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,811 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,811 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:02:48,817 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:02:48,817 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:02:48,818 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:02:48,821 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:48,822 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:48,822 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,822 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:48,822 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:02:48,834 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:02:48,834 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:02:49,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:49,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:49,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:49,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:49,087 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:02:49,092 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:02:49,092 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:02:49,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:49,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:49,329 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:49,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:49,330 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:02:49,333 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:02:49,333 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:02:49,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:49,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:49,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:56,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:02:56,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:02:56,813 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:56,813 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:02:56,813 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:02:56,817 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:02:56,817 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:03:01,422 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:03:01,423 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:03:01,423 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:03:01,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:03:01,424 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:03:01,432 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:03:01,434 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:04:23,265 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:04:23,265 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:04:25,563 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:04:25,563 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:04:25,563 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:04:25,563 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 39, 25, 563355), 'iat': datetime.datetime(2025, 7, 1, 10, 4, 25, 563357)}
2025-07-01 03:04:25,563 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:04:27,842 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:04:27,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:04:27,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:05:09,412 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:05:09,413 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:05:11,540 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:05:11,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:05:11,540 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:05:11,540 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 40, 11, 540433), 'iat': datetime.datetime(2025, 7, 1, 10, 5, 11, 540437)}
2025-07-01 03:05:11,541 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:05:13,989 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:05:13,989 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:05:14,000 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:05:14,000 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:05:14,001 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:05:16,102 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:05:16,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:05:16,102 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:05:16,102 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 40, 16, 102363), 'iat': datetime.datetime(2025, 7, 1, 10, 5, 16, 102365)}
2025-07-01 03:05:16,102 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:05:19,831 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:05:19,831 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:05:19,831 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:05:30,188 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:05:30,188 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:05:32,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:05:32,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:05:32,599 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:05:32,599 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 40, 32, 599785), 'iat': datetime.datetime(2025, 7, 1, 10, 5, 32, 599787)}
2025-07-01 03:05:32,600 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:05:34,792 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:05:34,792 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:05:36,746 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:05:36,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:05:36,746 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:05:36,746 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 40, 36, 746675), 'iat': datetime.datetime(2025, 7, 1, 10, 5, 36, 746678)}
2025-07-01 03:05:36,747 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:05:38,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:05:38,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:05:38,235 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:05:41,754 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:05:41,754 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:05:44,136 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:05:44,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:05:44,136 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:05:44,136 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 40, 44, 136075), 'iat': datetime.datetime(2025, 7, 1, 10, 5, 44, 136077)}
2025-07-01 03:05:44,136 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:05:46,466 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:05:46,466 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:05:48,424 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:05:48,424 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:05:48,424 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:05:48,424 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 40, 48, 424424), 'iat': datetime.datetime(2025, 7, 1, 10, 5, 48, 424426)}
2025-07-01 03:05:48,424 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:05:49,951 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:05:49,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:05:49,951 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:06:00,212 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:06:00,212 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:06:02,362 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:06:02,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:06:02,362 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:06:02,362 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 41, 2, 362510), 'iat': datetime.datetime(2025, 7, 1, 10, 6, 2, 362512)}
2025-07-01 03:06:02,362 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:06:04,900 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:06:04,901 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:06:06,798 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:06:06,798 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:06:06,798 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:06:06,798 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 41, 6, 798840), 'iat': datetime.datetime(2025, 7, 1, 10, 6, 6, 798842)}
2025-07-01 03:06:06,799 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:07:08,103 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:08,104 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:08,104 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:07:08,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:08,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:08,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:07:08,527 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365967, 'iat': 1751364167}
2025-07-01 03:07:08,527 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:07:08,531 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:07:08,532 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:07:08,532 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNjU5NjcsImlhdCI6MTc1MTM2NDE2N30.3UXpvytax1abuvjZd52N2T7PIho7Z5mcSCvRNHImwpQ
2025-07-01 03:07:08,532 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNjU5NjcsImlhdCI6MTc1MTM2NDE2N30.3UXpvytax1abuvjZd52N2T7PIho7Z5mcSCvRNHImwpQ
2025-07-01 03:07:21,259 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:07:21,260 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:07:21,260 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:07:21,261 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 10, 37, 21, 259614), 'iat': datetime.datetime(2025, 7, 1, 10, 7, 21, 259714)}
2025-07-01 03:07:21,261 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:07:21,262 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NjkyNDEsImlhdCI6MTc1MTM2NDQ0MX0.ZP1xsmTgHthr-rWgS0B7bNx9Hj8ZXNbuKQakI2Y5UGQ, Expiry (seconds): 604800
2025-07-01 03:07:21,270 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 03:07:22,425 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:22,425 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:22,426 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,426 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,426 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:07:22,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:22,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:22,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,427 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,427 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:07:22,431 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:07:22,431 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:07:22,432 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:07:22,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:22,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:22,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,438 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,438 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:07:22,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:22,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:22,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,439 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,439 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:07:22,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:22,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:22,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,444 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,444 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:07:22,452 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:07:22,452 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:07:22,452 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:07:22,463 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:07:22,464 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:07:22,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:22,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:22,717 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,717 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:22,717 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:07:22,726 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:07:22,726 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:07:23,047 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:23,048 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:23,048 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:23,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:07:23,309 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:07:23,309 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:23,310 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:07:23,310 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:07:23,316 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:07:23,317 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:09:14,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:09:14,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:09:14,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:09:14,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:09:14,052 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:09:14,058 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:09:14,059 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:10:21,667 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:10:21,667 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:10:23,909 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:10:23,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:10:23,909 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:10:23,909 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 45, 23, 909419), 'iat': datetime.datetime(2025, 7, 1, 10, 10, 23, 909421)}
2025-07-01 03:10:23,910 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:10:25,914 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:10:25,914 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:10:28,238 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:10:28,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:10:28,238 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:10:28,238 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 45, 28, 238581), 'iat': datetime.datetime(2025, 7, 1, 10, 10, 28, 238583)}
2025-07-01 03:10:28,239 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:10:30,810 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:10:30,810 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:10:33,241 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:10:33,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:10:33,241 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:10:33,241 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 45, 33, 241252), 'iat': datetime.datetime(2025, 7, 1, 10, 10, 33, 241254)}
2025-07-01 03:10:33,241 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:10:35,398 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:10:35,398 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:10:37,895 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:10:37,895 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:10:37,895 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:10:37,896 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 45, 37, 895863), 'iat': datetime.datetime(2025, 7, 1, 10, 10, 37, 895865)}
2025-07-01 03:10:37,896 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:10:40,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:10:40,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:10:40,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:10:51,514 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:10:51,514 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:10:53,677 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:10:53,677 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:10:53,677 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:10:53,677 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 45, 53, 677051), 'iat': datetime.datetime(2025, 7, 1, 10, 10, 53, 677056)}
2025-07-01 03:10:53,677 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:10:55,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:10:55,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:10:55,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:11:32,751 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:11:32,751 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:11:34,929 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:11:34,929 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:11:34,929 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:11:34,929 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 46, 34, 929632), 'iat': datetime.datetime(2025, 7, 1, 10, 11, 34, 929634)}
2025-07-01 03:11:34,930 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:11:36,842 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:11:36,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:11:36,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:11:54,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:11:54,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:11:54,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:11:54,302 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:11:54,302 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:11:54,304 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:11:54,304 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:12:46,088 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:12:46,088 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:12:48,472 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:12:48,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:12:48,472 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:12:48,472 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 47, 48, 472518), 'iat': datetime.datetime(2025, 7, 1, 10, 12, 48, 472520)}
2025-07-01 03:12:48,473 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:13:02,269 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:13:02,269 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:13:04,621 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:13:04,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:13:04,621 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:13:04,621 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 48, 4, 621398), 'iat': datetime.datetime(2025, 7, 1, 10, 13, 4, 621402)}
2025-07-01 03:13:04,622 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:13:07,538 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:13:07,539 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:13:10,690 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:13:10,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:13:10,691 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:13:10,691 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 48, 10, 690916), 'iat': datetime.datetime(2025, 7, 1, 10, 13, 10, 690918)}
2025-07-01 03:13:10,691 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:13:12,423 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:13:12,423 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:13:12,424 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:13:14,479 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:13:14,480 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:13:16,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:13:16,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:13:16,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:13:16,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 48, 16, 723123), 'iat': datetime.datetime(2025, 7, 1, 10, 13, 16, 723126)}
2025-07-01 03:13:16,723 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:13:18,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:13:18,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:13:18,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:13:28,389 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:13:28,389 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:13:30,449 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:13:30,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:13:30,449 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:13:30,449 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 48, 30, 449790), 'iat': datetime.datetime(2025, 7, 1, 10, 13, 30, 449791)}
2025-07-01 03:13:30,450 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:13:33,839 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:13:33,839 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:13:33,839 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:13:34,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:13:34,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:13:34,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:13:34,594 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:13:34,594 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:13:34,600 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:13:34,601 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:14:00,613 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:14:00,613 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:14:24,073 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:14:24,073 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:14:24,073 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:14:24,073 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 49, 24, 73326), 'iat': datetime.datetime(2025, 7, 1, 10, 14, 24, 73328)}
2025-07-01 03:14:24,073 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:14:26,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:26,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:26,629 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:14:26,629 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751366241, 'iat': 1751364441}
2025-07-01 03:14:26,629 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:14:26,635 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:14:26,635 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:14:26,635 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjYyNDEsImlhdCI6MTc1MTM2NDQ0MX0.DzEFHprQHLcabFETc0NBxV8kmnrBgwRRtjrpzNZ0NMM
2025-07-01 03:14:26,636 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjYyNDEsImlhdCI6MTc1MTM2NDQ0MX0.DzEFHprQHLcabFETc0NBxV8kmnrBgwRRtjrpzNZ0NMM
2025-07-01 03:14:41,137 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:14:41,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:14:41,138 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:14:41,138 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 10, 44, 41, 137755), 'iat': datetime.datetime(2025, 7, 1, 10, 14, 41, 137765)}
2025-07-01 03:14:41,138 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:14:41,138 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk2ODEsImlhdCI6MTc1MTM2NDg4MX0.g1_Ebh4t2Gz3p1PIwurw5XbTC8pQvBFka_g66aDNHX8, Expiry (seconds): 604800
2025-07-01 03:14:41,141 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-01 03:14:42,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:42,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:42,656 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:42,656 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:42,661 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:14:42,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:42,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:42,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:42,668 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:42,668 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:14:42,913 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:14:42,932 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:14:42,934 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:14:43,127 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:43,127 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:43,128 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:43,128 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:43,128 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:14:43,128 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:43,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:43,129 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:43,129 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:43,134 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:14:43,163 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:14:43,163 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:14:43,164 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:14:43,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:43,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:43,861 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:43,862 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:43,862 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:14:43,884 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:14:43,885 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:14:44,872 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:44,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:44,875 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:44,876 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:44,876 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:14:44,892 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:14:44,892 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:14:45,327 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:45,328 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:45,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:46,078 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:46,079 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:46,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:46,080 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:46,080 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:14:46,111 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:14:46,112 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:14:52,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:14:52,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:14:52,652 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:52,652 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:14:52,652 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:14:52,665 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:14:52,665 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:15:32,916 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:15:32,916 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:15:34,996 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:15:34,996 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:15:34,996 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:15:34,996 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 50, 34, 996082), 'iat': datetime.datetime(2025, 7, 1, 10, 15, 34, 996084)}
2025-07-01 03:15:34,996 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:15:37,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:15:37,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:15:37,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:13,844 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:16:13,844 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:16:16,378 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:16:16,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:16:16,378 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:16:16,378 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 51, 16, 378642), 'iat': datetime.datetime(2025, 7, 1, 10, 16, 16, 378644)}
2025-07-01 03:16:16,379 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:16:18,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:18,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:18,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,380 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:44,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:44,381 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,381 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,381 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:16:44,381 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:44,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:44,382 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,382 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,382 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:16:44,387 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:16:44,388 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:16:44,388 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:16:44,411 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:44,411 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:44,411 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,412 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,412 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:16:44,412 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:44,412 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:44,412 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,412 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,412 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:16:44,416 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:16:44,416 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:16:44,416 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:16:44,884 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:44,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:44,885 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,885 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:44,886 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:16:44,892 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:16:44,893 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:16:45,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:45,392 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:45,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:45,395 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:45,397 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:16:45,412 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:16:45,412 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:16:45,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:45,846 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:45,849 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:46,379 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:16:46,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:16:46,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:46,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:16:46,379 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:16:46,389 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:16:46,389 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:16:54,439 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:16:54,439 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:16:58,791 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:16:58,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:16:58,791 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:16:58,791 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 51, 58, 791238), 'iat': datetime.datetime(2025, 7, 1, 10, 16, 58, 791243)}
2025-07-01 03:16:58,791 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:17:01,344 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:17:01,344 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:17:01,355 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:01,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:01,356 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:17:03,809 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:17:03,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:17:03,809 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:17:03,809 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 52, 3, 809031), 'iat': datetime.datetime(2025, 7, 1, 10, 17, 3, 809033)}
2025-07-01 03:17:03,809 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:17:07,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:07,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:07,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:17:11,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:11,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:11,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:17:11,075 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751366681, 'iat': 1751364881}
2025-07-01 03:17:11,075 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:17:11,079 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:17:11,079 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:17:11,080 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNjY2ODEsImlhdCI6MTc1MTM2NDg4MX0.EGB-9pd-Q1Nsd8jEIAUK5ozPt6r0c0XkfuNDct51F6A
2025-07-01 03:17:11,081 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNjY2ODEsImlhdCI6MTc1MTM2NDg4MX0.EGB-9pd-Q1Nsd8jEIAUK5ozPt6r0c0XkfuNDct51F6A
2025-07-01 03:17:25,580 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:17:25,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:17:25,580 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:17:25,581 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 10, 19, 25, 580191), 'iat': datetime.datetime(2025, 7, 1, 10, 17, 25, 580209)}
2025-07-01 03:17:25,581 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:17:25,581 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk4NDUsImlhdCI6MTc1MTM2NTA0NX0.vOgwWoGo71uEcUQXy2x7gG-PdKnqAY-raucC0eruUvo, Expiry (seconds): 604800
2025-07-01 03:17:25,583 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-01 03:17:26,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:26,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:26,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,727 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,727 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:17:26,727 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:26,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:26,727 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,727 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,727 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:17:26,731 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:17:26,732 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:17:26,732 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:17:26,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:26,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:26,746 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,747 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,747 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:17:26,747 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:26,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:26,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,747 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,747 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:17:26,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:26,752 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:26,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:26,752 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:17:26,755 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:17:26,755 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:17:26,755 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:17:26,758 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:17:26,758 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:17:27,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:27,072 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:27,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:27,073 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:27,073 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:17:27,076 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:17:27,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:17:27,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:27,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:27,417 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:27,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:17:27,418 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:17:27,426 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:17:27,426 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:17:27,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:17:27,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:17:27,717 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751365165, 'iat': 1751365045}
2025-07-01 03:18:27,020 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:18:27,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:18:27,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969845, 'iat': 1751365045}
2025-07-01 03:18:27,022 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk4NDUsImlhdCI6MTc1MTM2NTA0NX0.vOgwWoGo71uEcUQXy2x7gG-PdKnqAY-raucC0eruUvo
2025-07-01 03:18:27,030 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk4NDUsImlhdCI6MTc1MTM2NTA0NX0.vOgwWoGo71uEcUQXy2x7gG-PdKnqAY-raucC0eruUvo
2025-07-01 03:18:27,031 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk4NDUsImlhdCI6MTc1MTM2NTA0NX0.vOgwWoGo71uEcUQXy2x7gG-PdKnqAY-raucC0eruUvo
2025-07-01 03:23:08,545 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:08,545 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:08,545 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969845, 'iat': 1751365045}
2025-07-01 03:23:08,545 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk4NDUsImlhdCI6MTc1MTM2NTA0NX0.vOgwWoGo71uEcUQXy2x7gG-PdKnqAY-raucC0eruUvo
2025-07-01 03:23:08,545 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk4NDUsImlhdCI6MTc1MTM2NTA0NX0.vOgwWoGo71uEcUQXy2x7gG-PdKnqAY-raucC0eruUvo
2025-07-01 03:23:19,972 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:19,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:19,973 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969845, 'iat': 1751365045}
2025-07-01 03:23:19,973 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk4NDUsImlhdCI6MTc1MTM2NTA0NX0.vOgwWoGo71uEcUQXy2x7gG-PdKnqAY-raucC0eruUvo
2025-07-01 03:23:19,974 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5Njk4NDUsImlhdCI6MTc1MTM2NTA0NX0.vOgwWoGo71uEcUQXy2x7gG-PdKnqAY-raucC0eruUvo
2025-07-01 03:23:22,744 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:22,745 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:22,745 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-01 03:23:22,752 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-01 03:23:32,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:32,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:32,234 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-01 03:23:32,237 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-01 03:23:38,476 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:23:38,477 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:23:43,203 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:23:43,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:23:43,203 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:23:43,203 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 10, 58, 43, 203641), 'iat': datetime.datetime(2025, 7, 1, 10, 23, 43, 203644)}
2025-07-01 03:23:43,204 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:23:55,072 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:23:55,072 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:23:55,072 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:23:55,072 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 10, 53, 55, 71973), 'iat': datetime.datetime(2025, 7, 1, 10, 23, 55, 71983)}
2025-07-01 03:23:55,073 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:23:55,074 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzAyMzUsImlhdCI6MTc1MTM2NTQzNX0.OFNAkLZOdXs-bQFnHXfnQptaeiEn8cslB1eHMLHBywo, Expiry (seconds): 604800
2025-07-01 03:23:55,083 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-01 03:23:56,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:56,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:56,233 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,233 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,233 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:23:56,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:56,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:56,234 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,234 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,234 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:23:56,245 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:23:56,245 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:23:56,245 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:23:56,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:56,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:56,254 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,255 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,255 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:23:56,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:56,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:56,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,255 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,255 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:23:56,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:56,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:56,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,258 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:23:56,263 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:23:56,263 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:23:56,264 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:23:56,267 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:23:56,267 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:23:56,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:56,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:56,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,512 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,512 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:23:56,519 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:23:56,520 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:23:56,824 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:56,824 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:56,825 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,825 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:23:56,825 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:23:56,830 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:23:56,830 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:23:57,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:23:57,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:23:57,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:24:04,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:24:04,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:24:04,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:24:04,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:24:04,920 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:24:04,928 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:24:04,929 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:25:17,292 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:25:17,292 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:25:19,421 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:25:19,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:25:19,421 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:25:19,421 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 0, 19, 421264), 'iat': datetime.datetime(2025, 7, 1, 10, 25, 19, 421265)}
2025-07-01 03:25:19,421 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:25:22,840 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:25:22,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:25:22,841 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:00,268 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:28:00,268 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:28:02,566 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:28:02,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:28:02,566 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:28:02,566 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 3, 2, 566326), 'iat': datetime.datetime(2025, 7, 1, 10, 28, 2, 566328)}
2025-07-01 03:28:02,566 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:28:05,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:05,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:05,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:15,682 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:15,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:15,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751970235, 'iat': 1751365435}
2025-07-01 03:28:15,682 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzAyMzUsImlhdCI6MTc1MTM2NTQzNX0.OFNAkLZOdXs-bQFnHXfnQptaeiEn8cslB1eHMLHBywo
2025-07-01 03:28:15,685 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzAyMzUsImlhdCI6MTc1MTM2NTQzNX0.OFNAkLZOdXs-bQFnHXfnQptaeiEn8cslB1eHMLHBywo
2025-07-01 03:28:15,686 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzAyMzUsImlhdCI6MTc1MTM2NTQzNX0.OFNAkLZOdXs-bQFnHXfnQptaeiEn8cslB1eHMLHBywo
2025-07-01 03:28:16,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:16,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:16,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,872 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,872 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:28:16,872 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:16,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:16,873 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,873 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,874 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:28:16,878 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:28:16,878 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:28:16,878 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:28:16,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:16,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:16,892 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,892 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,893 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:28:16,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:16,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:16,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,893 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,893 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:28:16,897 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:28:16,897 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:28:16,897 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:28:16,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:16,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:16,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:16,900 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:28:16,904 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:28:16,904 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:28:17,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:17,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:17,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:17,040 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:17,040 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:28:17,043 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:28:17,043 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:28:17,163 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:17,163 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:17,164 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:17,164 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:17,164 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:28:17,167 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:28:17,167 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:28:17,348 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:17,348 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:17,348 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:23,113 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:28:23,113 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:28:23,114 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:23,115 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:28:23,115 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:28:23,122 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:28:23,123 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:30:38,527 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:30:38,527 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:30:40,577 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:30:40,577 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:30:40,577 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:30:40,577 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 5, 40, 577126), 'iat': datetime.datetime(2025, 7, 1, 10, 30, 40, 577131)}
2025-07-01 03:30:40,577 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:30:42,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:30:42,451 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:30:42,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:31:28,868 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:31:28,868 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:31:31,262 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:31:31,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:31:31,262 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:31:31,262 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 6, 31, 262771), 'iat': datetime.datetime(2025, 7, 1, 10, 31, 31, 262773)}
2025-07-01 03:31:31,263 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:31:33,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:31:33,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:31:33,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:31:35,116 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:31:35,116 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:31:35,117 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751970235, 'iat': 1751365435}
2025-07-01 03:31:35,117 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzAyMzUsImlhdCI6MTc1MTM2NTQzNX0.OFNAkLZOdXs-bQFnHXfnQptaeiEn8cslB1eHMLHBywo
2025-07-01 03:31:35,118 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzAyMzUsImlhdCI6MTc1MTM2NTQzNX0.OFNAkLZOdXs-bQFnHXfnQptaeiEn8cslB1eHMLHBywo
2025-07-01 03:31:41,372 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:31:41,373 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:39:16,812 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:39:16,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:39:16,812 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:39:16,812 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 39, 16, 812258), 'iat': datetime.datetime(2025, 7, 1, 10, 39, 16, 812260)}
2025-07-01 03:39:16,812 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:40:29,853 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:40:29,854 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:40:29,854 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:40:29,854 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 40, 29, 853954), 'iat': datetime.datetime(2025, 7, 1, 10, 40, 29, 853957)}
2025-07-01 03:40:29,854 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:41:33,496 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:41:33,496 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:41:33,496 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:41:33,496 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 41, 33, 496453), 'iat': datetime.datetime(2025, 7, 1, 10, 41, 33, 496456)}
2025-07-01 03:41:33,496 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:41:34,861 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:41:34,861 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:41:34,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:41:39,323 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:41:39,323 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:41:42,690 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:41:42,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:41:42,690 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:41:42,691 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 41, 42, 690842), 'iat': datetime.datetime(2025, 7, 1, 10, 41, 42, 690844)}
2025-07-01 03:41:42,691 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:41:44,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:41:44,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:41:44,867 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751367235, 'iat': 1751365435}
2025-07-01 03:41:46,959 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:41:46,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:41:46,960 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751970235, 'iat': 1751365435}
2025-07-01 03:41:46,960 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzAyMzUsImlhdCI6MTc1MTM2NTQzNX0.OFNAkLZOdXs-bQFnHXfnQptaeiEn8cslB1eHMLHBywo
2025-07-01 03:41:46,962 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzAyMzUsImlhdCI6MTc1MTM2NTQzNX0.OFNAkLZOdXs-bQFnHXfnQptaeiEn8cslB1eHMLHBywo
2025-07-01 03:41:52,486 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:41:52,486 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:41:58,844 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:41:58,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:41:58,845 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:41:58,845 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 11, 11, 58, 844229), 'iat': datetime.datetime(2025, 7, 1, 10, 41, 58, 844253)}
2025-07-01 03:41:58,846 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:41:58,846 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NzEzMTgsImlhdCI6MTc1MTM2NjUxOH0.BC0K5nzuuYpXxgtlLlataPBb72yG82EFqpCGu1eIqIY, Expiry (seconds): 604800
2025-07-01 03:41:58,848 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 03:42:00,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:00,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:00,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,067 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,067 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:42:00,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:00,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:00,068 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,068 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:42:00,072 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:42:00,072 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:42:00,072 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:42:00,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:00,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:00,077 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,077 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,077 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:42:00,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:00,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:00,077 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,078 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,078 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:42:00,081 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:42:00,081 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:42:00,081 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:42:00,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:00,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:00,089 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,089 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,089 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:42:00,094 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:42:00,095 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:42:00,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:00,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:00,273 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,273 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:00,273 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:42:00,275 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:42:00,275 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:42:00,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:00,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:00,614 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:02,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:02,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:02,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:02,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:02,007 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:42:02,009 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:42:02,009 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:42:14,988 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:42:14,988 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:42:17,417 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:42:17,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:42:17,417 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:42:17,417 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'type': 'service_account', 'exp': datetime.datetime(2025, 7, 1, 11, 42, 17, 417352), 'iat': datetime.datetime(2025, 7, 1, 10, 42, 17, 417354)}
2025-07-01 03:42:17,417 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:42:18,369 - INFO - app.core.security - Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-07-01 03:42:19,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:19,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:19,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:19,435 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:19,436 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:42:19,461 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:42:19,462 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:42:20,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:20,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:20,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:30,004 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:42:30,005 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:42:33,445 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:42:33,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:42:33,445 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:42:33,445 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'type': 'service_account', 'exp': datetime.datetime(2025, 7, 1, 11, 42, 33, 445364), 'iat': datetime.datetime(2025, 7, 1, 10, 42, 33, 445366)}
2025-07-01 03:42:33,445 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:42:34,474 - INFO - app.core.security - Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-07-01 03:42:35,380 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:35,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:35,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:36,823 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:42:36,824 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:42:36,824 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:36,825 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:42:36,825 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:42:36,828 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:42:36,828 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:43:27,315 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:43:27,315 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:46:04,450 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 03:46:04,451 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 03:46:04,462 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 03:46:04,462 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 03:46:04,469 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:46:04,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:46:04,469 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:46:04,469 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 21, 4, 469604), 'iat': datetime.datetime(2025, 7, 1, 10, 46, 4, 469606)}
2025-07-01 03:46:04,470 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:46:06,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:06,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:06,221 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368318, 'iat': 1751366518}
2025-07-01 03:46:06,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:06,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:06,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751971318, 'iat': 1751366518}
2025-07-01 03:46:06,303 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NzEzMTgsImlhdCI6MTc1MTM2NjUxOH0.BC0K5nzuuYpXxgtlLlataPBb72yG82EFqpCGu1eIqIY
2025-07-01 03:46:06,307 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:46:06,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:46:06,307 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:46:06,307 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 11, 16, 6, 307095), 'iat': datetime.datetime(2025, 7, 1, 10, 46, 6, 307099)}
2025-07-01 03:46:06,307 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:46:06,307 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NzE1NjYsImlhdCI6MTc1MTM2Njc2Nn0.5AGbQmdLSZKv2DtcESR3Cu45TVwO2fmg94c3HykNKYw, Expiry (seconds): 604800
2025-07-01 03:46:06,308 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 03:46:07,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:07,013 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:07,013 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368566, 'iat': 1751366766}
2025-07-01 03:46:07,014 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368566, 'iat': 1751366766}
2025-07-01 03:46:07,014 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:07,019 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:07,019 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:07,019 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjg1NjYsImlhdCI6MTc1MTM2Njc2Nn0.RNBTPQ8gPG5zF4VmgGpwgYOZkSR_lAJLxd0rOXPzAuA
2025-07-01 03:46:07,020 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjg1NjYsImlhdCI6MTc1MTM2Njc2Nn0.RNBTPQ8gPG5zF4VmgGpwgYOZkSR_lAJLxd0rOXPzAuA
2025-07-01 03:46:19,101 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:46:19,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:46:19,102 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:46:19,102 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 11, 16, 19, 101644), 'iat': datetime.datetime(2025, 7, 1, 10, 46, 19, 101663)}
2025-07-01 03:46:19,102 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:46:19,103 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NzE1NzksImlhdCI6MTc1MTM2Njc3OX0.E_-aRpjpgpVHXQ_4RG-L8kCirrWwrDvtWoOyD2criEQ, Expiry (seconds): 604800
2025-07-01 03:46:19,106 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 03:46:20,260 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:20,260 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:20,261 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,261 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,261 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:46:20,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:20,261 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:20,262 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,262 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:20,269 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:20,269 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:20,269 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:20,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:20,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:20,275 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,275 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,275 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:46:20,276 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:20,276 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:20,276 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,276 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,276 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:20,279 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:20,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:20,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,279 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,279 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:20,281 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:20,281 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:20,281 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:20,288 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:20,288 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:20,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:20,523 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:20,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,523 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,523 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:20,530 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:20,530 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:20,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:20,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:20,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,893 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:20,893 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:20,899 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:20,899 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:21,150 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:21,150 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:21,150 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:26,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:26,484 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:26,484 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:26,485 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:26,485 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:46:26,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:26,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:26,485 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:26,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:26,486 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:26,489 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:26,490 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:26,490 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:27,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:27,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:27,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:27,107 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:27,107 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:46:27,108 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:27,108 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:27,108 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:27,108 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:27,108 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:27,115 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:27,115 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:27,115 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:28,011 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:28,011 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:28,011 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:28,011 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:28,011 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:46:28,011 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:28,012 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:28,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:28,013 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:28,013 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:28,022 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:28,022 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:28,022 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:35,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:35,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:35,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:35,172 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368579, 'iat': 1751366779}
2025-07-01 03:46:35,173 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:46:35,181 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:46:35,181 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:46:35,181 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjg1NzksImlhdCI6MTc1MTM2Njc3OX0.zcQ1h6w23jVgbzjO6kxE-aI8w4585za2Nf1-opwJ7tY
2025-07-01 03:46:35,182 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjg1NzksImlhdCI6MTc1MTM2Njc3OX0.zcQ1h6w23jVgbzjO6kxE-aI8w4585za2Nf1-opwJ7tY
2025-07-01 03:46:46,842 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:46:46,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:46:46,842 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:46:46,843 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 11, 16, 46, 842337), 'iat': datetime.datetime(2025, 7, 1, 10, 46, 46, 842347)}
2025-07-01 03:46:46,843 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:46:46,844 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzE2MDYsImlhdCI6MTc1MTM2NjgwNn0.DK6r-pTt11TEpSdKkeuvG3sfMMaqn-lss5QnkCtFZbY, Expiry (seconds): 604800
2025-07-01 03:46:46,847 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-01 03:46:47,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:48,000 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:48,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,000 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,000 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:46:48,000 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:48,000 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:48,001 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,001 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,001 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:46:48,009 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:46:48,009 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:46:48,009 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:46:48,031 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:48,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:48,032 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,033 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,033 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:46:48,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:48,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:48,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,034 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,034 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:46:48,038 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:48,038 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:48,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,039 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,039 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:46:48,045 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:46:48,045 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:46:48,045 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:46:48,049 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:46:48,049 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:46:48,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:48,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:48,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,303 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:46:48,308 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:46:48,308 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:46:48,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:48,640 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:48,641 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,641 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:46:48,641 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:46:48,646 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:46:48,646 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:46:48,925 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:46:48,925 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:46:48,925 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:36,789 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:36,789 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:36,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:36,791 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:36,791 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:47:36,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:36,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:36,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:36,792 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:36,792 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:47:36,796 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:47:36,796 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:47:36,796 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:47:37,400 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:37,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:37,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:37,401 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:37,401 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:47:37,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:37,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:37,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:37,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:37,401 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:47:37,405 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:47:37,405 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:47:37,405 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:47:44,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:44,252 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:44,252 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:44,253 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:44,253 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:47:44,260 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:47:44,260 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:47:47,123 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:47,123 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:47,124 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:47,124 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:47,124 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:47:47,129 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:47:47,129 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:47:48,097 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:48,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:48,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751971606, 'iat': 1751366806}
2025-07-01 03:47:48,099 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzE2MDYsImlhdCI6MTc1MTM2NjgwNn0.DK6r-pTt11TEpSdKkeuvG3sfMMaqn-lss5QnkCtFZbY
2025-07-01 03:47:48,114 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzE2MDYsImlhdCI6MTc1MTM2NjgwNn0.DK6r-pTt11TEpSdKkeuvG3sfMMaqn-lss5QnkCtFZbY
2025-07-01 03:47:48,116 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzE2MDYsImlhdCI6MTc1MTM2NjgwNn0.DK6r-pTt11TEpSdKkeuvG3sfMMaqn-lss5QnkCtFZbY
2025-07-01 03:47:53,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:53,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:53,234 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:53,234 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:53,234 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:47:53,239 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:47:53,240 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:47:56,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:47:56,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:47:56,150 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:56,150 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751368606, 'iat': 1751366806}
2025-07-01 03:47:56,150 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:47:56,156 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:47:56,156 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:48:09,894 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:48:09,894 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:48:09,895 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:48:09,895 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 11, 18, 9, 894550), 'iat': datetime.datetime(2025, 7, 1, 10, 48, 9, 894561)}
2025-07-01 03:48:09,895 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:48:09,895 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NzE2ODksImlhdCI6MTc1MTM2Njg4OX0.AzQN7_9Rs4RINMRiyiUXPERdV9-AixEcvDl8zlfsd0w, Expiry (seconds): 604800
2025-07-01 03:48:09,897 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 03:48:11,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:11,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:11,035 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,035 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,035 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:48:11,036 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:11,036 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:11,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,036 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:48:11,044 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:48:11,044 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:48:11,044 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:48:11,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:11,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:11,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,057 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,057 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:48:11,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:11,058 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:11,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,058 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,058 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:48:11,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:11,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:11,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,063 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,063 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:48:11,069 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:48:11,069 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:48:11,069 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:48:11,072 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:48:11,072 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:48:11,311 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:11,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:11,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,311 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,311 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:48:11,316 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:48:11,316 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:48:11,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:11,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:11,748 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,748 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:11,749 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:48:11,755 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:48:11,756 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:48:11,849 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:11,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:11,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:15,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:48:15,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:48:15,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:15,137 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:48:15,137 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:48:15,147 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:48:15,147 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:48:31,617 - INFO - app.core.security - Closing Redis connection...
2025-07-01 03:48:31,617 - INFO - app.core.security - Redis connection closed.
2025-07-01 03:54:10,052 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 03:54:10,052 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 03:54:10,066 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 03:54:10,066 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 03:54:10,069 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:54:10,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:54:10,069 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:54:10,069 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 29, 10, 69481), 'iat': datetime.datetime(2025, 7, 1, 10, 54, 10, 69482)}
2025-07-01 03:54:10,069 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:54:12,381 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:12,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:12,381 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751368689, 'iat': 1751366889}
2025-07-01 03:54:12,549 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:12,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:12,549 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751971689, 'iat': 1751366889}
2025-07-01 03:54:12,549 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NzE2ODksImlhdCI6MTc1MTM2Njg4OX0.AzQN7_9Rs4RINMRiyiUXPERdV9-AixEcvDl8zlfsd0w
2025-07-01 03:54:12,560 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:54:12,560 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:54:12,560 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:54:12,561 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 11, 24, 12, 560650), 'iat': datetime.datetime(2025, 7, 1, 10, 54, 12, 560656)}
2025-07-01 03:54:12,561 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:54:12,561 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NzIwNTIsImlhdCI6MTc1MTM2NzI1Mn0.a0vDCiWAqiV48A3vCGey3uRWnld2XHqr-vXxaHMg5j8, Expiry (seconds): 604800
2025-07-01 03:54:12,562 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 03:54:14,060 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:14,060 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:14,061 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751369052, 'iat': 1751367252}
2025-07-01 03:54:14,061 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751369052, 'iat': 1751367252}
2025-07-01 03:54:14,061 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 03:54:14,067 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 03:54:14,067 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 03:54:14,068 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjkwNTIsImlhdCI6MTc1MTM2NzI1Mn0.yF8PodR64D8wFS9BluPYpDqPHvBtG1EtcqqpmL4Saio
2025-07-01 03:54:14,069 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzNjkwNTIsImlhdCI6MTc1MTM2NzI1Mn0.yF8PodR64D8wFS9BluPYpDqPHvBtG1EtcqqpmL4Saio
2025-07-01 03:54:31,614 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 03:54:31,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 03:54:31,615 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 03:54:31,615 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 11, 24, 31, 614269), 'iat': datetime.datetime(2025, 7, 1, 10, 54, 31, 614287)}
2025-07-01 03:54:31,616 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 03:54:31,617 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g, Expiry (seconds): 604800
2025-07-01 03:54:31,624 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-01 03:54:32,805 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:32,805 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:32,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,806 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,806 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:54:32,806 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:32,806 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:32,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,806 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,806 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:32,811 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:32,812 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:32,812 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:32,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:32,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:32,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,819 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,819 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:54:32,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:32,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:32,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,820 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:32,825 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:32,825 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:32,825 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:32,829 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:32,829 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:32,830 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,830 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:32,830 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:32,836 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:32,836 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:33,078 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:33,079 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:33,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:33,079 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:33,079 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:33,082 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:33,082 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:33,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:33,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:33,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:33,589 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:33,590 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:33,594 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:33,594 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:33,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:33,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:33,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:40,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:40,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:40,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:40,690 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:40,690 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:54:40,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:40,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:40,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:40,692 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:40,692 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:40,699 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:40,699 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:40,700 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:41,402 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:41,402 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:41,402 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:41,403 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:41,403 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:54:41,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:41,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:41,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:41,404 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:41,404 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:41,412 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:41,412 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:41,412 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:42,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:42,061 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:42,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:42,062 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:42,062 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:54:42,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:42,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:42,063 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:42,063 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:42,063 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:42,070 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:42,070 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:42,071 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:42,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:42,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:42,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:42,698 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:42,698 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:54:42,698 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:42,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:42,699 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:42,699 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:42,699 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:42,707 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:42,708 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:42,708 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:54:59,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:54:59,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:54:59,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:59,139 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:54:59,139 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:54:59,149 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:54:59,150 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:55:41,491 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:55:41,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:55:41,492 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 03:55:41,492 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 03:55:41,504 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 03:55:41,505 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 03:55:48,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:55:48,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:55:48,068 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:55:48,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:55:48,068 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:55:48,079 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:55:48,079 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:56:06,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:56:06,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:56:06,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:56:06,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:56:06,733 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:56:06,737 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:56:06,738 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:56:17,355 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:56:17,358 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:56:17,358 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:56:17,359 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:56:17,359 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 03:56:17,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 03:56:17,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 03:56:17,360 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:56:17,360 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 03:56:17,360 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 03:56:17,370 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 03:56:17,370 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 03:56:17,371 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:01:54,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:01:54,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:01:54,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:01:54,375 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:01:54,376 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:02:18,266 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:02:18,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:02:18,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:02:18,266 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:02:18,266 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:02:18,270 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:02:18,270 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:02:37,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:02:37,398 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:02:37,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:02:37,405 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:02:37,408 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:02:37,446 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:02:37,447 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:02:54,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:02:54,340 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:02:54,340 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:02:54,341 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:02:54,347 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:03:02,312 - INFO - app.core.security - Closing Redis connection...
2025-07-01 04:03:02,313 - INFO - app.core.security - Redis connection closed.
2025-07-01 04:03:05,015 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 04:03:05,015 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 04:03:05,020 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 04:03:05,020 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 04:03:05,025 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 04:03:05,025 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 04:03:05,025 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 04:03:05,025 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 38, 5, 25212), 'iat': datetime.datetime(2025, 7, 1, 11, 3, 5, 25214)}
2025-07-01 04:03:05,025 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 04:03:07,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:03:07,850 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:03:07,851 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:03:46,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:03:46,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:03:46,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:03:46,270 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:03:46,271 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:03:54,959 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:03:54,960 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:03:54,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:03:54,962 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:03:54,962 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:03:54,983 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:03:54,983 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:04:16,728 - INFO - app.core.security - Closing Redis connection...
2025-07-01 04:04:16,728 - INFO - app.core.security - Redis connection closed.
2025-07-01 04:04:38,729 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 04:04:38,730 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 04:04:38,733 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 04:04:38,733 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 04:04:38,737 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 04:04:38,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 04:04:38,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 04:04:38,737 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 39, 38, 737864), 'iat': datetime.datetime(2025, 7, 1, 11, 4, 38, 737866)}
2025-07-01 04:04:38,738 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 04:04:40,243 - INFO - app.core.security - Closing Redis connection...
2025-07-01 04:04:40,243 - INFO - app.core.security - Redis connection closed.
2025-07-01 04:04:42,674 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 04:04:42,674 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 04:04:42,677 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 04:04:42,677 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 04:04:42,680 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 04:04:42,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 04:04:42,681 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 04:04:42,681 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 39, 42, 680944), 'iat': datetime.datetime(2025, 7, 1, 11, 4, 42, 680948)}
2025-07-01 04:04:42,681 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 04:04:44,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:04:44,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:04:44,280 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:04:44,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:04:44,280 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:04:44,381 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:04:44,381 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:04:44,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:04:44,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:04:44,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:04:44,470 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:04:44,470 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:04:44,473 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:04:44,473 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:04:44,559 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:04:44,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:04:44,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:04:44,560 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:04:44,560 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:04:44,561 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:04:44,561 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:04:44,786 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:04:44,786 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:04:44,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:05:01,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:05:01,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:05:01,248 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:05:01,248 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:05:01,248 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:05:01,253 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:05:01,254 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:05:39,894 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:05:39,894 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:05:39,894 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:05:39,894 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:05:39,895 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:07:41,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:07:41,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:07:41,499 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:07:41,499 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:07:41,500 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:08:19,825 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:08:19,825 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:08:19,825 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:08:19,826 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:08:19,827 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:08:51,103 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:08:51,104 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:08:51,104 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:08:51,104 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:08:51,106 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:08:54,361 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:08:54,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:08:54,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:08:54,362 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:08:54,362 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:08:54,365 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:08:54,365 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:09:03,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:09:03,093 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:09:03,094 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:03,094 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:03,095 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:09:03,099 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:09:03,099 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:09:12,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:09:12,590 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:09:12,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:12,590 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:12,591 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:09:12,598 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:09:12,599 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:09:20,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:09:20,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:09:20,219 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:09:20,220 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:09:20,221 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:09:24,413 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:09:24,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:09:24,414 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:24,414 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:24,414 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:09:24,416 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:09:24,417 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:09:33,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:09:33,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:09:33,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:33,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:33,087 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:09:33,092 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:09:33,093 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:09:54,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:09:54,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:09:54,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:54,433 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:09:54,433 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:09:54,439 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:09:54,440 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:10:14,133 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:10:14,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:10:14,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:10:14,134 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:10:14,134 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:10:14,141 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:10:14,141 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:10:20,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:10:20,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:10:20,224 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:10:20,225 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:10:20,226 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:11:11,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:11,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:11,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,712 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,712 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 04:11:11,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:11,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:11,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,713 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:11,716 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:11,717 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:11,717 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:11,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:11,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:11,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,733 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,733 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 04:11:11,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:11,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:11,734 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,734 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,734 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:11,738 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:11,738 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:11,738 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:11,840 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:11,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:11,841 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,841 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:11,841 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:11,848 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:11,848 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:12,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:12,072 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:12,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,072 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,072 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:12,076 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:12,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:12,422 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:12,422 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:12,423 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,423 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,423 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 04:11:12,423 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:12,423 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:12,423 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,424 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:12,427 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:12,427 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:12,427 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:12,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:12,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:12,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,435 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,435 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 04:11:12,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:12,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:12,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,437 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:12,440 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:12,440 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:12,440 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:12,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:12,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:12,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,443 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,444 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:12,448 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:12,448 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:12,637 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:12,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:12,637 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,637 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,637 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:12,641 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:12,641 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:12,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:12,850 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:12,851 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,851 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:12,851 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-01 04:11:12,855 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-01 04:11:12,855 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-01 04:11:13,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:11:13,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:11:13,121 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:11:18,402 - INFO - app.core.security - Closing Redis connection...
2025-07-01 04:11:18,404 - INFO - app.core.security - Redis connection closed.
2025-07-01 04:23:48,748 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 04:23:48,748 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 04:23:48,755 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 04:23:48,756 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 04:23:48,763 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 04:23:48,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 04:23:48,764 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 04:23:48,764 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 11, 58, 48, 763975), 'iat': datetime.datetime(2025, 7, 1, 11, 23, 48, 763979)}
2025-07-01 04:23:48,765 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 04:23:53,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:23:53,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:23:53,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751369071, 'iat': 1751367271}
2025-07-01 04:26:33,590 - INFO - app.core.security - Closing Redis connection...
2025-07-01 04:26:33,591 - INFO - app.core.security - Redis connection closed.
2025-07-01 04:44:56,678 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-01 04:44:56,678 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-01 04:44:56,682 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-01 04:44:56,682 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-01 04:44:56,686 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 04:44:56,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 04:44:56,686 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 04:44:56,686 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 12, 19, 56, 686873), 'iat': datetime.datetime(2025, 7, 1, 11, 44, 56, 686875)}
2025-07-01 04:44:56,687 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 04:45:00,050 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:45:00,050 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:45:00,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751972071, 'iat': 1751367271}
2025-07-01 04:45:00,051 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:45:00,051 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzIwNzEsImlhdCI6MTc1MTM2NzI3MX0.ULKT4UNPtpiunmWt0-GM3GbqfiJXvZEB8FMjZR9vz9g
2025-07-01 04:45:02,192 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:45:02,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:45:02,193 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-01 04:45:06,987 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:45:06,987 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:45:06,988 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-01 04:45:06,990 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-01 04:49:48,262 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-01 04:49:48,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-01 04:49:48,263 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-01 04:49:48,263 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 12, 19, 48, 262699), 'iat': datetime.datetime(2025, 7, 1, 11, 49, 48, 262710)}
2025-07-01 04:49:48,263 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-01 04:49:48,264 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NzUzODgsImlhdCI6MTc1MTM3MDU4OH0.6Uo7loPrpgjZQ_sqFvcC6q8vkWcwrtVMUXSvO8KNHWk, Expiry (seconds): 604800
2025-07-01 04:49:48,269 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-01 04:49:49,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:49:49,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:49:49,369 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,369 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,369 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 04:49:49,369 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:49:49,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:49:49,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,370 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,370 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 04:49:49,375 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 04:49:49,375 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 04:49:49,375 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 04:49:49,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:49:49,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:49:49,385 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,385 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,385 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-01 04:49:49,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:49:49,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:49:49,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,386 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 04:49:49,391 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 04:49:49,391 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 04:49:49,391 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-01 04:49:49,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:49:49,392 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:49:49,393 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,393 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,393 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 04:49:49,397 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 04:49:49,397 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 04:49:49,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:49:49,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:49:49,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,687 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 04:49:49,692 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 04:49:49,692 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 04:49:49,952 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:49:49,953 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:49:49,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,953 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:49:49,953 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-01 04:49:49,958 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-01 04:49:49,958 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-01 04:49:50,001 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-01 04:49:50,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-01 04:49:50,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751372388, 'iat': 1751370588}
2025-07-01 04:50:11,903 - INFO - app.core.security - Closing Redis connection...
2025-07-01 04:50:11,904 - INFO - app.core.security - Redis connection closed.
